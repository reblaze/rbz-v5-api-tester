{
    "Name": "TA 1376 Content filter profile headers parameters ui tests",
    "Skip": false,
    "Tests": [
        {
            "Name": "Test 1: name/regex selection",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: User can create content filter profile with header`s name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_name\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_name\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with header`s regex",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_regex"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_regex\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_regex\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [],\"regex\":[{\"type\": \"regex\",\"key\": \"test\",\"reg\": \"test\",\"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\": \"header_regex\"}],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 2: Key field validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: User cannot create content filter profile with empty header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_empty_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_empty_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_empty_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_empty_key\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                },
                {
                    "Name": "Step: User cannot create content filter profile with same header`s keys",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_same_header_keys"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_same_header_keys\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_same_header_keys\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\",\"key\": \"same-text\",\"reg\": \"test\",\"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\": \"header_same_key\"},{\"type\": \"names\",\"key\": \"same-text\",\"reg\": \"test2\",\"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\": \"header_same_key2\"}],\"regex\": [],\"max_count\": 42,\"enable_max_count\": false,\"max_length\": 1024,\"enable_max_length\": false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with long header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_long_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_long_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_long_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_long_key\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with special chars header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_spec_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_spec_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_spec_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"!@#$%^&*()<>'_-.\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_spec_key\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with regex header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_regex_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_regex_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_regex_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\":[],\"regex\":[{\"type\":\"regex\",\"key\":\"('|\\\")[^-]*bc--\",\"reg\":\"test\",\"restrict\":false,\"mask\":false,\"exclusions\":[],\"id\":\"arg_reg_key\"}],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with wrong regex header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_wrong_regex_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_wrong_regex_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_wrong_regex_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\":[],\"regex\":[{\"type\":\"regex\",\"key\":\"[0-9]++\",\"reg\":\"test\",\"restrict\":false,\"mask\":false,\"exclusions\":[],\"id\":\"arg_reg_key\"}],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with leading space header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_leading_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_leading_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_leading_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"  leading\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_leading_key\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify header`s key with leading space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_leading_header_key"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "test_cfr_leading_header_key"
                            },
                            {
                                "Key": "id",
                                "Value": "test_cfr_leading_header_key"
                            },
                            {
                                "Key": "headers",
                                "Value": "{'names': [{'type': 'names', 'key': 'leading', 'reg': 'test', 'restrict': False, 'mask': False, 'exclusions': [], 'id': 'header_leading_key'}], 'regex': [], 'max_count': 42, 'enable_max_count': False, 'max_length': 1024, 'enable_max_length': False}"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with trailing space header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_trailing_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_trailing_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_trailing_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"trailing  \", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_trailing_key\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify header`s key with trailing space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_trailing_header_key"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "test_cfr_trailing_header_key"
                            },
                            {
                                "Key": "id",
                                "Value": "test_cfr_trailing_header_key"
                            },
                            {
                                "Key": "headers",
                                "Value": "{'names': [{'type': 'names', 'key': 'trailing', 'reg': 'test', 'restrict': False, 'mask': False, 'exclusions': [], 'id': 'header_trailing_key'}], 'regex': [], 'max_count': 42, 'enable_max_count': False, 'max_length': 1024, 'enable_max_length': False}"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create content filter profile with space header`s key",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_space_header_key"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_space_header_key\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_space_header_key\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \" \", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_space_key\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                }
            ]
        },
        {
            "Name": "Test 3: Matching value validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: User cannot create content filter profile with empty header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_empty_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_empty_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_empty_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_empty_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with same header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_same_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_same_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_same_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\",\"key\": \"test\",\"reg\": \"same-text\",\"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\": \"header_same_matching\"},{\"type\": \"names\",\"key\": \"test2\",\"reg\": \"same-text\",\"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\": \"header_same_matching2\"}],\"regex\": [],\"max_count\": 42,\"enable_max_count\": false,\"max_length\": 1024,\"enable_max_length\": false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with long header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_long_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_long_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_long_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_long_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with special chars header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_spec_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_spec_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_spec_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"!@#$%^&*()<>'_-.\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_spec_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with regex header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_regex_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_regex_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_regex_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"('|\\\")[^-]*bc--\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_reg_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with wrong regex header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_wrong_regex_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_wrong_regex_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_wrong_regex_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"[0-9]++\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_wrong_reg_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with leading space header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_leading_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_leading_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_leading_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"  leading\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_leading_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify header`s matching with leading space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_leading_header_matching"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "test_cfr_leading_header_matching"
                            },
                            {
                                "Key": "id",
                                "Value": "test_cfr_leading_header_matching"
                            },
                            {
                                "Key": "headers",
                                "Value": "{'names': [{'type': 'names', 'key': 'test', 'reg': 'leading', 'restrict': False, 'mask': False, 'exclusions': [], 'id': 'header_leading_matching'}], 'regex': [], 'max_count': 42, 'enable_max_count': False, 'max_length': 1024, 'enable_max_length': False}"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with trailing space header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_trailing_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_trailing_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_trailing_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"trailing  \", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_trailing_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify header`s matching with trailing space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_trailing_header_matching"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "test_cfr_trailing_header_matching"
                            },
                            {
                                "Key": "id",
                                "Value": "test_cfr_trailing_header_matching"
                            },
                            {
                                "Key": "headers",
                                "Value": "{'names': [{'type': 'names', 'key': 'test', 'reg': 'trailing', 'restrict': False, 'mask': False, 'exclusions': [], 'id': 'header_trailing_matching'}], 'regex': [], 'max_count': 42, 'enable_max_count': False, 'max_length': 1024, 'enable_max_length': False}"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create content filter profile with space header`s matching",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_space_header_matching"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_space_header_matching\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_space_header_matching\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \" \", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_space_matching\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                }
            ]
        },
        {
            "Name": "Test 4: Restrict checkbox",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: User can create content filter profile with checked restrict",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_checked_restrict"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_checked_restrict\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_checked_restrict\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": true,\"mask\": false,\"exclusions\": [],\"id\":\"header_restrict\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can uncheck content filter profile header`s restrict",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_checked_restrict"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_checked_restrict\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_checked_restrict\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_restrict\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 5: Mask checkbox",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: User can create content filter profile with checked mask",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_checked_mask"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_checked_mask\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_checked_mask\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": true,\"exclusions\": [],\"id\":\"header_mask\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can uncheck content filter profile header`s mask",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_checked_mask"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_checked_mask\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_checked_mask\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_mask\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 6: Ignore field",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: User can create content filter profile with empty ignore field",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_empty_ignore"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_empty_ignore\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_empty_ignore\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [],\"id\":\"header_ignore\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with one tag in ignore field",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_one_tag_ignore"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_one_tag_ignore\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_one_tag_ignore\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [\"one-tag\"],\"id\":\"header_one_tag\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with several tags in ignore field",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_several_tags_ignore"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_several_tags_ignore\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_several_tags_ignore\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [\"tag1\", \"tag2\", \"tag3\"],\"id\":\"header_several_tags\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with long tag in ignore field",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_long_tag_ignore"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_long_tag_ignore\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_long_tag_ignore\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"],\"id\":\"header_long_tag\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create content filter profile with spec chars tag in ignore field",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-content-filter-profiles",
                        "Path": "/test_cfr_header_spec_tag_ignore"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test_cfr_header_spec_tag_ignore\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test_cfr_header_spec_tag_ignore\""
                            },
                            {
                                "Key": "headers",
                                "Value": "{\"names\": [{\"type\": \"names\", \"key\": \"test\", \"reg\": \"test\", \"restrict\": false,\"mask\": false,\"exclusions\": [\"!@#$%^&*()<>'_-.\"],\"id\":\"header_spec_tag\"}],\"regex\":[],\"max_count\":42,\"enable_max_count\":false,\"max_length\":1024,\"enable_max_length\":false}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                }
            ]
        }
    ]
}