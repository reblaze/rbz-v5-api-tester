{
    "Name": "TA 1402 Security policy add edit delete security policy",
    "Skip": false,
    "Tests": [
        {
            "Name": "Test 1: Check created new security policy",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Create new security policy 'sp-test'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-test"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"sp-test\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"sp-test\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Check default values of security policy 'sp-test'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-test"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "sp-test"
                            },
                            {
                                "Key": "id",
                                "Value": "sp-test"
                            },
                            {
                                "Key": "map",
                                "Value": "[{\"id\": \"__root_entry__\",\"name\": \"__root__\",\"match\": \"^/(\\\\W.*)?$\",\"acl_profile\": \"__acldefault__\",\"acl_active\": true,\"backend_id\": \"__default__\",\"cloud_functions\": [],\"content_filter_profile\": \"__defaultcontentfilter__\",\"content_filter_active\": true,\"limit_ids\": []},{\"id\": \"__default_entry__\",\"name\": \"__default__\",\"match\": \"/\",\"acl_profile\": \"__acldefault__\",\"acl_active\": true,\"backend_id\": \"__default__\",\"cloud_functions\": [],\"content_filter_profile\": \"__defaultcontentfilter__\",\"content_filter_active\": true,\"limit_ids\": []}]"
                            },
                            {
                                "Key": "session",
                                "Value": "[{'attrs': 'ip'}]"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 2: Name field validation",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Create an security policy with name 'security_policy_text_name'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_text_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"security_policy_text_name\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"security_policy_text_name\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a security policy with empty name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_empty_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"security_policy_empty_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                },
                {
                    "Name": "Step: User cannot create a security_policy with exist name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_exist_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"security_policy_exist_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"security_policy_text_name\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "409",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Error: 409 Conflict: entry with name security_policy_text_name already exists in document [securitypolicies]"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create a security policy with long name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_long_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"security_policy_long_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create a security policy with special chars name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_spec_chars_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"security_policy_spec_chars_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"!@#$%^&*()<>'_-.\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a security policy with space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_space_char_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"security_policy_space_char_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\" \""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                },
                {
                    "Name": "Step: User can create a security policy with leading space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_leading_space_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"security_policy_leading_space_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"  security_policy_leading_space_name\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Check security policy with leading space char in name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_leading_space_name"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "security_policy_leading_space_name"
                            },
                            {
                                "Key": "id",
                                "Value": "security_policy_leading_space_name"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create a security policy with trailing space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_trailing_space_name"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"security_policy_trailing_space_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"security_policy_trailing_space_name  \""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Check security policy with trailing space char in name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/security_policy_trailing_space_name"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "security_policy_trailing_space_name"
                            },
                            {
                                "Key": "id",
                                "Value": "security_policy_trailing_space_name"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 3: Tags field",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a security policy 'sp-tag'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add `no tags` to the security policy `sp-tag`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add one tag to the security policy `sp-tag`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"one\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add several tags to the security policy `sp-tag`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"one\", \"two\", \"three\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add long tag to the security policy `sp-tag`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add tag with special chars to the security policy `sp-tag`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"!@#$%^&*()<>'_-.\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot add a tag with two chars to the security policy `sp-tag`",
                    "Skip": true,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"aa\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                },
                {
                    "Name": "Step: User cannot add a tag with space chars to the security policy `sp-tag`.",
                    "Skip": true,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\" \"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                },
                {
                    "Name": "Step: User can add to security policy `sp-tag` a tag with leading space char",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"  leading\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify tag with leading space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "sp-tag"
                            },
                            {
                                "Key": "id",
                                "Value": "sp-tag"
                            },
                            {
                                "Key": "tags",
                                "Value": "['leading']"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add to security policy `sp-tag` a tag with trailing space char ",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"sp-tag\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"trailing  \"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify tag with trailing space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-tag"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "name",
                                "Value": "sp-tag"
                            },
                            {
                                "Key": "id",
                                "Value": "sp-tag"
                            },
                            {
                                "Key": "tags",
                                "Value": "['trailing']"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 4: Description",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a security policy 'sp-description' with description",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-description"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-description\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-description\""
                            },
                            {
                                "Key": "description",
                                "Value": "\"Security policy with description\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Create a security policy 'sp-no-description' without description",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-no-description"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"sp-no-description\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"sp-no-description\""
                            },
                            {
                                "Key": "description",
                                "Value": "\"\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 5: Edit",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a rate limit with name 'rl_test'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-rate-limits",
                        "Path": "/rl_test"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"rl_test\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"rl_test\""
                            },
                            {
                                "Key": "active",
                                "Value": "true"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Create security policy 'sp-rl'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-rl"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"sp-rl\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"sp-rl\""
                            },
                            {
                                "Key": "map",
                                "Value": "[{\"id\": \"__root_entry__\",\"name\": \"__root__\",\"match\": \"^/(\\\\W.*)?$\",\"acl_profile\": \"__acldefault__\",\"acl_active\": true,\"backend_id\": \"__default__\",\"cloud_functions\": [],\"content_filter_profile\": \"__defaultcontentfilter__\",\"content_filter_active\": true,\"limit_ids\": []},{\"id\": \"__default_entry__\",\"name\": \"__default__\",\"match\": \"/\",\"acl_profile\": \"__acldefault__\",\"acl_active\": true,\"backend_id\": \"__default__\",\"cloud_functions\": [],\"content_filter_profile\": \"__defaultcontentfilter__\",\"content_filter_active\": true,\"limit_ids\": []}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Update security policy with attached rate limit 'rl_test'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-rl"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"sp-rl\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"sp-rl\""
                            },
                            {
                                "Key": "map",
                                "Value": "[{\"id\": \"__root_entry__\",\"name\": \"__root__changed__\",\"match\": \"/match\",\"acl_profile\": \"__acldefault__\",\"acl_active\": false,\"backend_id\": \"__default__\",\"cloud_functions\": [],\"content_filter_profile\": \"__defaultcontentfilter__\",\"content_filter_active\": false,\"limit_ids\": []},{\"id\": \"__default_entry__\",\"name\": \"__default__changed__\",\"match\": \"/match\",\"acl_profile\": \"__acldefault__\",\"acl_active\": false,\"backend_id\": \"__default__\",\"cloud_functions\": [],\"content_filter_profile\": \"__defaultcontentfilter__\",\"content_filter_active\": false,\"limit_ids\": [\"rl_test\"]}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully updated entry"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 6: Delete",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Create security policy 'sp-not-attached'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-not-attached"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"sp-not-attached\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"sp-not-attached\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Create security policy 'sp-attached'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-security-policies",
                        "Path": "/sp-attached"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"sp-attached\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"sp-attached\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Create new server group 'test.site' ",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-server-groups",
                        "Path": "/test-site"
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"test-site\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"test-site\""
                            },
                            {
                                "Key": "server_names",
                                "Value": "[\"test.site\"]"
                            },
                            {
                                "Key": "security_policy",
                                "Value": "\"sp-attached\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "201",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully created entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can delete the security policy 'sp-not-attached'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-server-groups",
                        "Path": "/sp-not-attached"
                    },
                    "Method": "DELETE",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "message",
                                "Value": "Successfully deleted entry"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot delete security policy 'sp-attached' attached to server group ",
                    "Skip": true,
                    "GenerateID": false,
                    "API": {
                        "Base": "api-server-groups",
                        "Path": "/sp-attached"
                    },
                    "Method": "DELETE",
                    "Expected": {
                        "Code": "400",
                        "Type": "status-code"
                    }
                }
            ]
        }
    ]
}