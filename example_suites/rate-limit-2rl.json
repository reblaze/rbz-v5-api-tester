{
  "Name": "Rate Limit - 2 rl TA-1312",
  "Skip": false,
  "Tests": [
    {
      "Name": "Rate Limit - 2 rl",
      "Skip": false,
      "Steps": [
        {
          "Name": "Create Rate limit 'step1-monitor'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step1-monitor\""
              },
              {
                "Key": "id",
                "Value": "\"step1-monitor\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "15"
              },
              {
                "Key": "threshold",
                "Value": "1"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\": \"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-monitor\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step1-block'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step1-block\""
              },
              {
                "Key": "id",
                "Value": "\"step1-block\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "15"
              },
              {
                "Key": "threshold",
                "Value": "1"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\": \"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step2-challenge'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step2-challenge\""
              },
              {
                "Key": "id",
                "Value": "\"step2-challenge\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "15"
              },
              {
                "Key": "threshold",
                "Value": "1"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\": \"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-challenge\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step2-block'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step2-block\""
              },
              {
                "Key": "id",
                "Value": "\"step2-block\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "15"
              },
              {
                "Key": "threshold",
                "Value": "1"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\": \"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step3-block1'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step3-block1\""
              },
              {
                "Key": "id",
                "Value": "\"step3-block1\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "15"
              },
              {
                "Key": "threshold",
                "Value": "1"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\": \"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step3-block2'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step3-block2\""
              },
              {
                "Key": "id",
                "Value": "\"step3-block2\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "15"
              },
              {
                "Key": "threshold",
                "Value": "1"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\": \"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step4-ban-monitor'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step4-ban-monitor\""
              },
              {
                "Key": "id",
                "Value": "\"step4-ban-monitor\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "10"
              },
              {
                "Key": "threshold",
                "Value": "2"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\":\"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-monitor\""
              },
              {
                "Key": "is_action_ban",
                "Value": "true"
              },
              {
                "Key": "ttl",
                "Value": "120"
              },
              {
                "Key": "tags",
                "Value": " [\n\"my-test\"\n]"
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step4-block'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step4-block\""
              },
              {
                "Key": "id",
                "Value": "\"step4-block\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "60"
              },
              {
                "Key": "threshold",
                "Value": "4"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step5-ban-challenge'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step5-ban-challenge\""
              },
              {
                "Key": "id",
                "Value": "\"step5-ban-challenge\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "20"
              },
              {
                "Key": "threshold",
                "Value": "2"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\":\"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-challenge\""
              },
              {
                "Key": "is_action_ban",
                "Value": "true"
              },
              {
                "Key": "ttl",
                "Value": "120"
              },
              {
                "Key": "tags",
                "Value": " [\n\"my-test\"\n]"
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step5-block'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step5-block\""
              },
              {
                "Key": "id",
                "Value": "\"step5-block\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "60"
              },
              {
                "Key": "threshold",
                "Value": "4"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step6-ban-block'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step6-ban-block\""
              },
              {
                "Key": "id",
                "Value": "\"step6-ban-block\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "20"
              },
              {
                "Key": "threshold",
                "Value": "2"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\":\"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              },
              {
                "Key": "is_action_ban",
                "Value": "true"
              },
              {
                "Key": "ttl",
                "Value": "120"
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step6-monitor'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step6-monitor\""
              },
              {
                "Key": "id",
                "Value": "\"step6-monitor\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "60"
              },
              {
                "Key": "threshold",
                "Value": "4"
              },
              {
                "Key": "action",
                "Value": "\"action-monitor\""
              },
              {
                "Key": "tags",
                "Value": " [\n\"my-test\"\n]"
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step7-ban-block'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step7-ban-block\""
              },
              {
                "Key": "id",
                "Value": "\"step7-ban-block\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "20"
              },
              {
                "Key": "threshold",
                "Value": "2"
              },
              {
                "Key": "key",
                "Value": "[\n{\n\"attrs\":\"ip\"\n}\n]"
              },
              {
                "Key": "action",
                "Value": "\"action-rate-limit-block\""
              },
              {
                "Key": "is_action_ban",
                "Value": "true"
              },
              {
                "Key": "ttl",
                "Value": "120"
              },
              {
                "Key": "tags",
                "Value": " [\n\"my-test\"\n]"
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Rate limit 'step7-challenge'",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "rate-limit",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"step7-challenge\""
              },
              {
                "Key": "id",
                "Value": "\"step7-challenge\""
              },
              {
                "Key": "active",
                "Value": "true"
              },
              {
                "Key": "global",
                "Value": "false"
              },
              {
                "Key": "timeframe",
                "Value": "60"
              },
              {
                "Key": "threshold",
                "Value": "4"
              },
              {
                "Key": "action",
                "Value": "\"action-challenge\""
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create Security Policy 'testSP'",
          "Skip": false,
          "API": {
            "Base": "security-policy",
            "Path": ""
          },
          "Method": "POST",
          "Payload": {
            "Params": [
              {
                "Key": "name",
                "Value": "\"testSP\""
              },
              {
                "Key": "id",
                "Value": "\"test_security_policy\""
              },
              {
                "Key": "session",
                "Value": "[{\n\"attrs\":\"ip\"\n}]"
              },
              {
                "Key": "map",
                "Value": "[\n{\n\"id\":\"__root_entry__\",\n\"name\":\"__root__\",\n\"match\":\"^/(\\\\W.*)?$\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[]\n},\n{\n\"id\":\"__default_entry__\",\n\"name\":\"__default__\",\n\"match\":\"/\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[]\n},\n{\n\"id\":\"d8a077aceec1\",\n\"name\":\"step1\",\n\"match\":\"/step1\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[\n\"step1-block\",\n\"step1-monitor\"\n]\n},\n{\n\"id\":\"63444656b321\",\n\"name\":\"step2\",\n\"match\":\"/step2\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[\n\"step2-block\",\n\"step2-challenge\"\n]\n},\n{\n\"id\":\"fc7ee586dffe\",\n\"name\":\"step3\",\n\"match\":\"/step3\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[\n\"step3-block1\",\n\"step3-block2\"\n]\n},\n{\n\"id\":\"8f2369f8c3cb\",\n\"name\":\"step4\",\n\"match\":\"/step4\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[\n\"step4-ban-monitor\",\n\"step4-block\"\n]\n},\n{\n\"id\":\"b34c23eccd23\",\n\"name\":\"step5\",\n\"match\":\"/step5\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[\n\"step5-ban-challenge\",\n\"step5-block\"\n]\n},\n{\n\"id\":\"aa41ec8fbf67\",\n\"name\":\"step6\",\n\"match\":\"/step6\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[\n\"step6-ban-block\",\n\"step6-monitor\"\n]\n},\n{\n\"id\":\"25fe0b2388d2\",\n\"name\":\"step7\",\n\"match\":\"/step7\",\n\"acl_profile\":\"__acldefault__\",\n\"acl_active\":true,\n\"backend_id\":\"__default__\",\n\"cloud_functions\":[],\n\"content_filter_profile\":\"__defaultcontentfilter__\",\n\"content_filter_active\":true,\n\"limit_ids\":[\n\"step7-ban-block\",\n\"step7-challenge\"\n]\n}\n]"
              }
            ]
          },
          "Expected": {
            "Code": "200",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "ok",
                "Value": true
              }
            ]
          }
        },
        {
          "Name": "Create server group 'test.site' ",
          "Skip": false,
          "GenerateID": false,
          "API": {
            "Base": "server-group",
            "Path": "test-site/"
          },
          "Method": "POST",
          "Payload": {
            "Template": "servergroup.template",
            "Defaults": "servergroup.defaults",
            "Params": [
              {
                "Key": "id",
                "Value": "\"test-site\""
              },
              {
                "Key": "name",
                "Value": "\"test-site\""
              },
              {
                "Key": "security_policy",
                "Value": "\"test_security_policy\""
              },
              {
                "Key": "server_names",
                "Value": "[\"test.site\"]"
              }
            ]
          },
          "Expected": {
            "Code": "201",
            "Type": "json",
            "Single": true,
            "SingleResult": [
              {
                "Key": "id",
                "Value": "test-site"
              }
            ]
          }
        },
        {
          "ID": "publish-changes",
          "Skip": false
        },
        {
          "ID": "wait-for-publish",
          "Skip": false
        },
        {
          "Name": "Send Traffic using GET method to path /step1 1",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step1"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step1 2",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step1"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step2 22",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step2"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step2 23",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step2"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step3 24",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step3"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step3 25",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step3"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step4 3",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step4"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step4 4",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step4"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step4 5",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step4"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step4 6",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step4"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step4 7",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step4"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step5 8",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step5"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step5 9",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step5"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step5 10",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step5"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "247",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step5 11",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step5"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "247",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step5 12",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step5"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step6 13",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step6"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step6 14",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step6"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step6 15",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step6"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step6 16",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step6"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step6 17",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step6"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step7 18",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step7"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step7 19",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step7"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step7 20",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step7"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step7 21",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step7"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "Name": "Send Traffic using GET method to path /step7 22",
          "Skip": false,
          "API": {
            "Base": "send-traffic",
            "Path": "/step7"
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "Host",
              "Value": "test.site"
            }
          ],
          "Expected": {
            "Code": "471",
            "Type": "content",
            "Single": true,
            "Text": "b''"
          }
        },
        {
          "ID": "wait-for-logs",
          "Skip": false
        },
        {
          "Name": "Assert logs verify path '/step1'",
          "Skip": false,
          "API": {
            "Base": "logs",
            "Path": ""
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "syntax",
              "Value": "string_query"
            }
          ],
          "Arguments": [
            {
              "Key": "limit",
              "Value": "200"
            },
            {
              "Key": "filters",
              "Value": "path=\"/step1\", tags=\"status:471\", timestamp between @@NOW(-10minutes)@@ and @@NOW(+10minutes)@@, branch=@@branch@@"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "jsonpath",
            "Single": true,
            "Headers": [
              {
                "Key": "Server",
                "Value": "rhino-core-shield"
              }
            ],
            "SingleResult": [
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step1-block"
              },
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step1-monitor"
              }
            ]
          }
        },
        {
          "Name": "Assert logs verify path '/step2'",
          "Skip": false,
          "API": {
            "Base": "logs",
            "Path": ""
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "syntax",
              "Value": "string_query"
            }
          ],
          "Arguments": [
            {
              "Key": "limit",
              "Value": "200"
            },
            {
              "Key": "filters",
              "Value": "path=\"/step2\", tags=\"status:471\", timestamp between @@NOW(-10minutes)@@ and @@NOW(+10minutes)@@, branch=@@branch@@"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "jsonpath",
            "Single": true,
            "Headers": [
              {
                "Key": "Server",
                "Value": "rhino-core-shield"
              }
            ],
            "SingleResult": [
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step2-block"
              },
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step2-challenge"
              }
            ]
          }
        },
        {
          "Name": "Assert logs verify path '/step3'",
          "Skip": false,
          "API": {
            "Base": "logs",
            "Path": ""
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "syntax",
              "Value": "string_query"
            }
          ],
          "Arguments": [
            {
              "Key": "limit",
              "Value": "200"
            },
            {
              "Key": "filters",
              "Value": "path=\"/step3\", tags=\"status:471\", timestamp between @@NOW(-10minutes)@@ and @@NOW(+10minutes)@@, branch=@@branch@@"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "jsonpath",
            "Single": true,
            "Headers": [
              {
                "Key": "Server",
                "Value": "rhino-core-shield"
              }
            ],
            "SingleResult": [
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step3-block1"
              },
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step3-block2"
              }
            ]
          }
        },
        {
          "Name": "Assert logs verify path 'step4'",
          "Skip": false,
          "API": {
            "Base": "logs",
            "Path": ""
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "syntax",
              "Value": "string_query"
            }
          ],
          "Arguments": [
            {
              "Key": "limit",
              "Value": "200"
            },
            {
              "Key": "filters",
              "Value": "path=\"/step4\", tags=\"status:471\", timestamp between @@NOW(-10minutes)@@ and @@NOW(+10minutes)@@, branch=@@branch@@"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "jsonpath",
            "Single": true,
            "Headers": [
              {
                "Key": "Server",
                "Value": "rhino-core-shield"
              }
            ],
            "SingleResult": [
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step4-ban-monitor"
              },
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step4-block"
              }
            ]
          }
        },
        {
          "Name": "Assert logs verify path 'step5'",
          "Skip": false,
          "API": {
            "Base": "logs",
            "Path": ""
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "syntax",
              "Value": "string_query"
            }
          ],
          "Arguments": [
            {
              "Key": "limit",
              "Value": "200"
            },
            {
              "Key": "filters",
              "Value": "path=\"/step5\", tags=\"status:471\", timestamp between @@NOW(-10minutes)@@ and @@NOW(+10minutes)@@, branch=@@branch@@"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "jsonpath",
            "Single": true,
            "Headers": [
              {
                "Key": "Server",
                "Value": "rhino-core-shield"
              }
            ],
            "SingleResult": [
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step5-ban-challenge"
              },
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step5-block"
              }
            ]
          }
        },
        {
          "Name": "Assert logs verify path 'step6'",
          "Skip": false,
          "API": {
            "Base": "logs",
            "Path": ""
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "syntax",
              "Value": "string_query"
            }
          ],
          "Arguments": [
            {
              "Key": "limit",
              "Value": "200"
            },
            {
              "Key": "filters",
              "Value": "path=\"/step6\", tags=\"status:471\", timestamp between @@NOW(-10minutes)@@ and @@NOW(+10minutes)@@, branch=@@branch@@"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "jsonpath",
            "Single": true,
            "Headers": [
              {
                "Key": "Server",
                "Value": "rhino-core-shield"
              }
            ],
            "SingleResult": [
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step6-ban-block"
              },
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step6-monitor"
              },
              {
                "Key": "data/results/1/tags/*",
                "Value": "limit-name:step6-ban-block"
              },
              {
                "Key": "data/results/2/tags/*",
                "Value": "limit-name:step6-ban-block"
              }
            ]
          }
        },
        {
          "Name": "Assert logs verify path 'step7'",
          "Skip": false,
          "API": {
            "Base": "logs",
            "Path": ""
          },
          "Method": "GET",
          "Headers": [
            {
              "Key": "syntax",
              "Value": "string_query"
            }
          ],
          "Arguments": [
            {
              "Key": "limit",
              "Value": "200"
            },
            {
              "Key": "filters",
              "Value": "path=\"/step7\", tags=\"status:471\", timestamp between @@NOW(-10minutes)@@ and @@NOW(+10minutes)@@, branch=@@branch@@"
            }
          ],
          "Expected": {
            "Code": "200",
            "Type": "jsonpath",
            "Single": true,
            "Headers": [
              {
                "Key": "Server",
                "Value": "rhino-core-shield"
              }
            ],
            "SingleResult": [
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step7-ban-block"
              },
              {
                "Key": "data/results/0/tags/*",
                "Value": "limit-name:step7-challenge"
              },
              {
                "Key": "data/results/1/tags/*",
                "Value": "limit-name:step7-ban-block"
              },
              {
                "Key": "data/results/2/tags/*",
                "Value": "limit-name:step7-ban-block"
              }
            ]
          }
        }
      ]
    }
  ]
}