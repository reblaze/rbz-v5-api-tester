{
    "Name": "TA 1291 Global filters edit page UI tests",
    "Skip": true,
    "Tests": [
        {
            "Name": "Test 1: Create a global filter from the list page",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 2: delete global filter",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf1\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf1\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can delete global filter 'gf1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf1/"
                    },
                    "Method" :"DELETE",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Create a global filter 'gf-source1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf-source1\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf-source1\""
                            },
                            {
                                "Key": "source",
                                "Value": "\"https://lists.blocklist.de/lists/strongips.txt\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Update source of the global filter 'gf_source1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "gf-fetch",
                        "Path": "fetch?url=https://lists.blocklist.de/lists/strongips.txt"
                    },
                    "Method": "GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "content",
						"Single": true,
                        "Text": "b'1.9.78.242\\n101.207.113.73\\n103.16.202.187\\n103.231.46.66\\n103.26.136.173\\n103.37.83.26\\n103.48.192.48\\n103.48.193.7\\n103.63.108.25\\n103.86.180.10\\n103.92.24.242\\n104.199.35.3\\n104.248.159.207\\n104.45.17.110\\n105.96.11.65\\n106.241.54.211\\n106.246.224.154\\n106.51.3.214\\n107.0.200.227\\n107.175.33.240\\n107.180.88.176\\n111.118.21.121\\n111.161.41.156\\n111.21.99.227\\n111.68.98.152\\n111.93.200.50\\n112.220.238.3\\n112.31.56.247\\n112.64.32.118\\n112.64.33.38\\n113.200.60.74\\n114.199.123.211\\n116.92.213.114\\n117.220.15.119\\n118.101.192.62\\n118.201.79.222\\n118.45.205.44\\n118.70.170.120\\n118.70.180.188\\n118.70.180.189\\n119.252.143.6\\n119.28.105.34\\n119.28.118.4\\n119.29.136.114\\n119.5.157.124\\n119.73.179.114\\n120.224.50.233\\n120.28.109.188\\n120.88.46.226\\n121.142.87.218\\n122.155.0.205\\n122.176.52.13\\n123.140.114.196\\n123.30.149.76\\n123.30.249.49\\n123.31.29.192\\n124.152.118.194\\n124.160.96.242\\n124.194.74.203\\n124.207.165.138\\n125.129.82.220\\n125.141.139.29\\n125.163.160.229\\n125.212.233.50\\n125.99.173.162\\n128.199.120.146\\n128.199.182.19\\n128.199.194.1\\n128.199.225.7\\n128.199.33.46\\n128.199.73.168\\n128.199.95.60\\n128.199.99.204\\n128.201.78.253\\n129.213.100.212\\n13.74.46.65\\n13.80.7.122\\n134.122.17.178\\n134.122.8.241\\n134.17.17.32\\n134.17.94.229\\n134.209.103.181\\n136.228.161.66\\n136.228.161.67\\n137.184.5.137\\n138.197.66.68\\n138.68.239.113\\n138.68.9.83\\n139.198.120.226\\n139.215.195.61\\n139.59.127.178\\n139.59.188.13\\n139.59.23.154\\n139.59.248.243\\n139.59.25.164\\n139.59.255.59\\n14.177.239.168\\n14.63.162.98\\n140.86.12.31\\n140.86.39.162\\n141.94.106.15\\n141.98.11.11\\n141.98.11.68\\n141.98.11.90\\n143.110.176.216\\n143.110.241.56\\n143.244.144.227\\n143.244.162.174\\n148.66.132.190\\n154.68.39.6\\n154.72.194.207\\n157.230.185.9\\n157.230.83.80\\n157.230.91.199\\n159.192.143.249\\n159.203.170.197\\n159.223.59.81\\n159.65.128.16\\n159.65.133.50\\n159.65.220.18\\n159.65.41.104\\n159.65.91.105\\n159.89.131.172\\n159.89.163.158\\n160.153.252.142\\n161.35.108.241\\n164.177.31.66\\n164.77.117.10\\n165.22.101.75\\n165.22.16.134\\n165.22.217.96\\n165.22.242.64\\n165.227.101.226\\n165.227.166.247\\n165.227.68.95\\n165.227.84.172\\n165.227.85.21\\n167.172.112.115\\n171.244.140.174\\n171.34.70.28\\n175.207.13.22\\n177.91.80.11\\n178.128.215.16\\n178.217.173.54\\n178.22.168.219\\n178.46.163.191\\n179.131.10.103\\n179.27.60.34\\n180.101.88.196\\n180.101.88.197\\n180.101.88.218\\n180.101.88.219\\n180.101.88.220\\n180.101.88.221\\n180.101.88.222\\n180.101.88.223\\n180.101.88.224\\n180.101.88.225\\n180.101.88.237\\n180.101.88.240\\n180.101.88.244\\n180.101.88.245\\n180.101.88.246\\n180.101.88.248\\n180.167.207.234\\n180.168.95.234\\n180.71.47.198\\n181.30.99.114\\n181.48.99.155\\n181.49.50.202\\n182.16.245.79\\n182.16.245.85\\n182.23.23.42\\n182.59.139.27\\n182.72.142.62\\n182.75.216.74\\n182.93.7.194\\n183.240.157.2\\n184.18.211.199\\n185.217.1.246\\n185.224.128.142\\n185.246.130.20\\n185.36.81.40\\n185.46.18.99\\n185.74.4.17\\n185.74.4.189\\n185.74.4.20\\n186.10.125.209\\n186.10.245.152\\n186.10.86.130\\n186.147.129.110\\n186.38.26.5\\n186.4.222.45\\n186.67.248.5\\n186.67.248.6\\n186.67.248.8\\n187.102.174.154\\n187.188.206.106\\n187.188.240.7\\n188.166.211.7\\n188.234.247.110\\n189.206.165.62\\n189.240.225.205\\n189.6.45.130\\n190.104.25.210\\n190.117.113.32\\n190.12.102.58\\n190.128.169.130\\n190.128.171.250\\n190.128.230.98\\n190.128.241.2\\n190.129.60.125\\n190.144.14.170\\n190.145.192.106\\n190.145.81.37\\n190.153.249.99\\n190.202.124.93\\n190.210.182.179\\n190.85.108.186\\n190.85.15.251\\n192.241.157.126\\n194.152.206.17\\n195.239.91.210\\n195.88.120.62\\n197.5.145.68\\n198.12.85.199\\n198.23.148.137\\n20.194.60.135\\n200.105.183.118\\n200.108.143.6\\n200.122.249.203\\n200.42.176.235\\n200.70.56.202\\n201.116.3.194\\n201.149.49.146\\n201.163.162.179\\n201.226.239.98\\n201.234.66.133\\n201.236.101.194\\n201.249.57.5\\n201.249.89.102\\n201.48.78.29\\n201.70.52.10\\n202.158.139.57\\n202.21.123.196\\n202.51.74.123\\n202.55.175.236\\n202.83.16.8\\n202.88.241.107\\n203.106.164.74\\n203.113.167.3\\n203.130.255.2\\n203.172.76.4\\n203.205.37.224\\n203.205.37.233\\n203.66.168.81\\n203.98.76.172\\n205.214.74.6\\n206.189.129.144\\n206.217.131.233\\n207.154.228.201\\n208.109.15.199\\n208.109.34.15\\n210.3.92.14\\n210.65.88.51\\n211.112.187.197\\n211.193.31.52\\n211.21.113.128\\n211.244.45.196\\n211.253.10.96\\n211.253.27.169\\n212.83.144.11\\n213.230.67.32\\n218.255.245.10\\n218.56.160.82\\n218.92.0.100\\n218.92.0.101\\n218.92.0.107\\n218.92.0.112\\n218.92.0.113\\n218.92.0.118\\n218.92.0.123\\n218.92.0.22\\n218.92.0.24\\n218.92.0.25\\n218.92.0.26\\n218.92.0.27\\n218.92.0.28\\n218.92.0.29\\n218.92.0.31\\n218.92.0.32\\n218.92.0.33\\n218.92.0.34\\n218.92.0.39\\n218.92.0.40\\n218.92.0.43\\n218.92.0.45\\n218.92.0.47\\n218.92.0.48\\n218.92.0.51\\n218.92.0.52\\n218.92.0.53\\n218.92.0.55\\n218.92.0.56\\n218.92.0.59\\n218.92.0.76\\n218.92.0.96\\n220.134.113.188\\n220.80.223.144\\n220.86.29.35\\n220.88.1.208\\n221.130.59.248\\n221.156.126.1\\n221.157.75.252\\n221.213.129.46\\n222.107.156.227\\n222.124.214.10\\n222.168.30.19\\n222.252.243.104\\n222.255.115.237\\n223.171.46.146\\n223.197.151.55\\n223.197.175.91\\n223.197.186.7\\n223.197.188.206\\n27.254.137.144\\n27.254.149.199\\n31.184.198.71\\n34.64.215.4\\n34.81.69.1\\n34.91.0.68\\n34.92.176.182\\n35.186.145.141\\n35.199.73.100\\n35.199.97.42\\n35.207.98.222\\n35.240.204.250\\n35.244.25.124\\n36.110.228.254\\n36.155.130.6\\n36.66.151.17\\n36.67.197.52\\n36.91.166.34\\n36.91.38.31\\n36.94.81.243\\n41.72.105.171\\n41.72.219.102\\n41.82.208.182\\n42.200.149.223\\n42.200.66.164\\n42.200.78.78\\n45.129.14.120\\n45.20.209.253\\n45.232.244.5\\n46.101.5.100\\n47.180.114.229\\n47.180.212.134\\n49.247.198.162\\n49.247.213.18\\n49.51.183.1\\n50.192.223.205\\n50.214.100.27\\n50.225.176.238\\n52.160.46.145\\n52.172.30.44\\n52.183.128.237\\n52.227.167.147\\n58.186.85.94\\n58.27.95.2\\n59.3.76.218\\n60.220.185.22\\n60.220.185.61\\n61.102.42.5\\n61.177.172.136\\n61.177.172.140\\n61.177.172.160\\n61.177.172.179\\n61.76.169.138\\n61.80.179.118\\n61.93.186.125\\n62.28.222.221\\n64.225.22.216\\n64.227.122.198\\n64.227.126.250\\n65.181.73.155\\n65.190.102.226\\n66.249.155.244\\n68.116.41.2\\n68.183.132.72\\n68.183.88.186\\n72.167.55.58\\n72.240.125.133\\n79.104.0.82\\n80.94.95.181\\n81.192.87.130\\n81.28.167.30\\n82.200.65.218\\n84.2.226.70\\n85.172.189.189\\n85.209.11.27\\n88.214.25.16\\n89.179.126.155\\n89.252.140.21\\n89.97.218.142\\n91.92.245.73\\n92.50.249.166\\n93.108.242.140\\n94.180.247.20\\n95.156.96.46\\n96.56.221.138\\n96.67.59.65\\n96.69.13.140\\n96.78.175.36\\n96.93.196.89\\n'"
                    }
                },
                {
                    "Name": "Step: User can delete global filter 'gf-source1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf-source1/"
                    },
                    "Method" :"DELETE",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot delete global filter 'API Discovery'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "rbz-api-discovery/"
                    },
                    "Method": "DELETE",

                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                }
            ]
        },
        {
            "Name": "Test 3: Edit global filters",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf2'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf2\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf2\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add entries to the section global filter 'gf2'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf2/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf2\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf2\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.1.1.1\", \"ip\"]]}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change name of global filter 'gf2'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf2/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf2-changed\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf2\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Create a global filter 'gf_source2'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf_source2\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf_source2\""
                            },
                            {
                                "Key": "source",
                                "Value": "\"https://lists.blocklist.de/lists/strongips.txt\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Update source of the global filter 'gf_source1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "gf-fetch",
                        "Path": "fetch?url=https://lists.blocklist.de/lists/strongips.txt"
                    },
                    "Method": "GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "content",
						"Single": true,
                        "Text": "b'1.9.78.242\\n101.207.113.73\\n103.16.202.187\\n103.231.46.66\\n103.26.136.173\\n103.37.83.26\\n103.48.192.48\\n103.48.193.7\\n103.63.108.25\\n103.86.180.10\\n103.92.24.242\\n104.199.35.3\\n104.248.159.207\\n104.45.17.110\\n105.96.11.65\\n106.241.54.211\\n106.246.224.154\\n106.51.3.214\\n107.0.200.227\\n107.175.33.240\\n107.180.88.176\\n111.118.21.121\\n111.161.41.156\\n111.21.99.227\\n111.68.98.152\\n111.93.200.50\\n112.220.238.3\\n112.31.56.247\\n112.64.32.118\\n112.64.33.38\\n113.200.60.74\\n114.199.123.211\\n116.92.213.114\\n117.220.15.119\\n118.101.192.62\\n118.201.79.222\\n118.45.205.44\\n118.70.170.120\\n118.70.180.188\\n118.70.180.189\\n119.252.143.6\\n119.28.105.34\\n119.28.118.4\\n119.29.136.114\\n119.5.157.124\\n119.73.179.114\\n120.224.50.233\\n120.28.109.188\\n120.88.46.226\\n121.142.87.218\\n122.155.0.205\\n122.176.52.13\\n123.140.114.196\\n123.30.149.76\\n123.30.249.49\\n123.31.29.192\\n124.152.118.194\\n124.160.96.242\\n124.194.74.203\\n124.207.165.138\\n125.129.82.220\\n125.141.139.29\\n125.163.160.229\\n125.212.233.50\\n125.99.173.162\\n128.199.120.146\\n128.199.182.19\\n128.199.194.1\\n128.199.225.7\\n128.199.33.46\\n128.199.73.168\\n128.199.95.60\\n128.199.99.204\\n128.201.78.253\\n129.213.100.212\\n13.74.46.65\\n13.80.7.122\\n134.122.17.178\\n134.122.8.241\\n134.17.17.32\\n134.17.94.229\\n134.209.103.181\\n136.228.161.66\\n136.228.161.67\\n137.184.5.137\\n138.197.66.68\\n138.68.239.113\\n138.68.9.83\\n139.198.120.226\\n139.215.195.61\\n139.59.127.178\\n139.59.188.13\\n139.59.23.154\\n139.59.248.243\\n139.59.25.164\\n139.59.255.59\\n14.177.239.168\\n14.63.162.98\\n140.86.12.31\\n140.86.39.162\\n141.94.106.15\\n141.98.11.11\\n141.98.11.68\\n141.98.11.90\\n143.110.176.216\\n143.110.241.56\\n143.244.144.227\\n143.244.162.174\\n148.66.132.190\\n154.68.39.6\\n154.72.194.207\\n157.230.185.9\\n157.230.83.80\\n157.230.91.199\\n159.192.143.249\\n159.203.170.197\\n159.223.59.81\\n159.65.128.16\\n159.65.133.50\\n159.65.220.18\\n159.65.41.104\\n159.65.91.105\\n159.89.131.172\\n159.89.163.158\\n160.153.252.142\\n161.35.108.241\\n164.177.31.66\\n164.77.117.10\\n165.22.101.75\\n165.22.16.134\\n165.22.217.96\\n165.22.242.64\\n165.227.101.226\\n165.227.166.247\\n165.227.68.95\\n165.227.84.172\\n165.227.85.21\\n167.172.112.115\\n171.244.140.174\\n171.34.70.28\\n175.207.13.22\\n177.91.80.11\\n178.128.215.16\\n178.217.173.54\\n178.22.168.219\\n178.46.163.191\\n179.131.10.103\\n179.27.60.34\\n180.101.88.196\\n180.101.88.197\\n180.101.88.218\\n180.101.88.219\\n180.101.88.220\\n180.101.88.221\\n180.101.88.222\\n180.101.88.223\\n180.101.88.224\\n180.101.88.225\\n180.101.88.237\\n180.101.88.240\\n180.101.88.244\\n180.101.88.245\\n180.101.88.246\\n180.101.88.248\\n180.167.207.234\\n180.168.95.234\\n180.71.47.198\\n181.30.99.114\\n181.48.99.155\\n181.49.50.202\\n182.16.245.79\\n182.16.245.85\\n182.23.23.42\\n182.59.139.27\\n182.72.142.62\\n182.75.216.74\\n182.93.7.194\\n183.240.157.2\\n184.18.211.199\\n185.217.1.246\\n185.224.128.142\\n185.246.130.20\\n185.36.81.40\\n185.46.18.99\\n185.74.4.17\\n185.74.4.189\\n185.74.4.20\\n186.10.125.209\\n186.10.245.152\\n186.10.86.130\\n186.147.129.110\\n186.38.26.5\\n186.4.222.45\\n186.67.248.5\\n186.67.248.6\\n186.67.248.8\\n187.102.174.154\\n187.188.206.106\\n187.188.240.7\\n188.166.211.7\\n188.234.247.110\\n189.206.165.62\\n189.240.225.205\\n189.6.45.130\\n190.104.25.210\\n190.117.113.32\\n190.12.102.58\\n190.128.169.130\\n190.128.171.250\\n190.128.230.98\\n190.128.241.2\\n190.129.60.125\\n190.144.14.170\\n190.145.192.106\\n190.145.81.37\\n190.153.249.99\\n190.202.124.93\\n190.210.182.179\\n190.85.108.186\\n190.85.15.251\\n192.241.157.126\\n194.152.206.17\\n195.239.91.210\\n195.88.120.62\\n197.5.145.68\\n198.12.85.199\\n198.23.148.137\\n20.194.60.135\\n200.105.183.118\\n200.108.143.6\\n200.122.249.203\\n200.42.176.235\\n200.70.56.202\\n201.116.3.194\\n201.149.49.146\\n201.163.162.179\\n201.226.239.98\\n201.234.66.133\\n201.236.101.194\\n201.249.57.5\\n201.249.89.102\\n201.48.78.29\\n201.70.52.10\\n202.158.139.57\\n202.21.123.196\\n202.51.74.123\\n202.55.175.236\\n202.83.16.8\\n202.88.241.107\\n203.106.164.74\\n203.113.167.3\\n203.130.255.2\\n203.172.76.4\\n203.205.37.224\\n203.205.37.233\\n203.66.168.81\\n203.98.76.172\\n205.214.74.6\\n206.189.129.144\\n206.217.131.233\\n207.154.228.201\\n208.109.15.199\\n208.109.34.15\\n210.3.92.14\\n210.65.88.51\\n211.112.187.197\\n211.193.31.52\\n211.21.113.128\\n211.244.45.196\\n211.253.10.96\\n211.253.27.169\\n212.83.144.11\\n213.230.67.32\\n218.255.245.10\\n218.56.160.82\\n218.92.0.100\\n218.92.0.101\\n218.92.0.107\\n218.92.0.112\\n218.92.0.113\\n218.92.0.118\\n218.92.0.123\\n218.92.0.22\\n218.92.0.24\\n218.92.0.25\\n218.92.0.26\\n218.92.0.27\\n218.92.0.28\\n218.92.0.29\\n218.92.0.31\\n218.92.0.32\\n218.92.0.33\\n218.92.0.34\\n218.92.0.39\\n218.92.0.40\\n218.92.0.43\\n218.92.0.45\\n218.92.0.47\\n218.92.0.48\\n218.92.0.51\\n218.92.0.52\\n218.92.0.53\\n218.92.0.55\\n218.92.0.56\\n218.92.0.59\\n218.92.0.76\\n218.92.0.96\\n220.134.113.188\\n220.80.223.144\\n220.86.29.35\\n220.88.1.208\\n221.130.59.248\\n221.156.126.1\\n221.157.75.252\\n221.213.129.46\\n222.107.156.227\\n222.124.214.10\\n222.168.30.19\\n222.252.243.104\\n222.255.115.237\\n223.171.46.146\\n223.197.151.55\\n223.197.175.91\\n223.197.186.7\\n223.197.188.206\\n27.254.137.144\\n27.254.149.199\\n31.184.198.71\\n34.64.215.4\\n34.81.69.1\\n34.91.0.68\\n34.92.176.182\\n35.186.145.141\\n35.199.73.100\\n35.199.97.42\\n35.207.98.222\\n35.240.204.250\\n35.244.25.124\\n36.110.228.254\\n36.155.130.6\\n36.66.151.17\\n36.67.197.52\\n36.91.166.34\\n36.91.38.31\\n36.94.81.243\\n41.72.105.171\\n41.72.219.102\\n41.82.208.182\\n42.200.149.223\\n42.200.66.164\\n42.200.78.78\\n45.129.14.120\\n45.20.209.253\\n45.232.244.5\\n46.101.5.100\\n47.180.114.229\\n47.180.212.134\\n49.247.198.162\\n49.247.213.18\\n49.51.183.1\\n50.192.223.205\\n50.214.100.27\\n50.225.176.238\\n52.160.46.145\\n52.172.30.44\\n52.183.128.237\\n52.227.167.147\\n58.186.85.94\\n58.27.95.2\\n59.3.76.218\\n60.220.185.22\\n60.220.185.61\\n61.102.42.5\\n61.177.172.136\\n61.177.172.140\\n61.177.172.160\\n61.177.172.179\\n61.76.169.138\\n61.80.179.118\\n61.93.186.125\\n62.28.222.221\\n64.225.22.216\\n64.227.122.198\\n64.227.126.250\\n65.181.73.155\\n65.190.102.226\\n66.249.155.244\\n68.116.41.2\\n68.183.132.72\\n68.183.88.186\\n72.167.55.58\\n72.240.125.133\\n79.104.0.82\\n80.94.95.181\\n81.192.87.130\\n81.28.167.30\\n82.200.65.218\\n84.2.226.70\\n85.172.189.189\\n85.209.11.27\\n88.214.25.16\\n89.179.126.155\\n89.252.140.21\\n89.97.218.142\\n91.92.245.73\\n92.50.249.166\\n93.108.242.140\\n94.180.247.20\\n95.156.96.46\\n96.56.221.138\\n96.67.59.65\\n96.69.13.140\\n96.78.175.36\\n96.93.196.89\\n'"
                    }
                },
                {
                    "Name": "Step: User cannot add entries to the section of the global filter 'gf_source2'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf_source2/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf_source2\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf_source2\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.1.1.1\", \"ip\"]]}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User can change name of global filter 'gf_source2'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf_source2/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf_source2_changed\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf_source2\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot add entries to the section global filter 'Deny Tor'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "rbz-deny-tor/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"Deny Tor\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"rbz-deny-tor\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.1.1.1\", \"ip\"]]}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot change source global filter 'Facebook Crawlers'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "rbz-facebook/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"Facebook Crawlers\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"rbz-facebook\""
                            },
                            {
                                "Key": "source",
                                "Value": "\"https://lists.blocklist.de/lists/strongips.txt\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot change name of global filter 'Googlebots'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "rbz-googlebots/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"Googlebots-changed\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"rbz-googlebots\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Test": "b''"
                    }
                }

            ]
        },
        {
            "Name": "Test 4: Global filter`s name field validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: User can create a global filter with text name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"textname\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"textname\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a global filter with empty name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf3\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n'' is too short\\n\\nFailed validating 'minLength' in schema['properties']['name']:\\n    {'description': 'Name of entity shown in UI',\\n     'minLength': 1,\\n     'title': 'Name',\\n     'type': 'string'}\\n\\nOn instance['name']:\\n    ''\""
                    }
                },
                {
                    "Name": "Step: User cannot create a global filter with the same name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"textname\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf4\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "409",
                        "Type": "content",
                        "Single": true,
                        "Text": "b'409 Conflict: entry with name textname already exists in document [globalfilters]'"
                    }
                },
                {
                    "Name": "Step: User can create a global filter with long name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf5\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create a global filter with special chars name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"!@#$%^&*()<>'_-.\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf6\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a global filter with space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\" \""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf7\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n' ' is too short\\n\\nFailed validating 'minLength' in schema['properties']['name']:\\n    {'description': 'Name of entity shown in UI',\\n     'minLength': 1,\\n     'title': 'Name',\\n     'type': 'string'}\\n\\nOn instance['name']:\\n    ''\""
                    }
                },
                {
                    "Name": "Step: User can create a global filter with leading name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"   leading\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf8\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify global filter`s name with leading space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf8/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "leading"
                            },
                            {
                                "Key": "id",
                                "Value": "gf8"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create a global filter with trailing name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"trailing   \""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf9\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify global filter`s name with trailing space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf9/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "trailing"
                            },
                            {
                                "Key": "id",
                                "Value": "gf9"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 5: Tags field",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf10'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add `no tags` to the global filter `gf9`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add one tag to the global filter `gf10`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"one\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add several tags to the global filter `gf9`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"one\", \"two\", \"three\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add long tag to the global filter `gf10`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add tag with special chars to the global filter `gf10`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"!@#$%^&*()<>'_-.\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot add a tag with two chars to the global filter `gf10`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\"aa\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot add a tag with space chars to global filter `gf10`.",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "tags",
                                "Value": "[\" \"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User can add to global filter `gf10` a tag with leading space char",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"  leading\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify tag with leading space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "gf10"
                            },
                            {
                                "Key": "id",
                                "Value": "gf10"
                            },
                            {
                                "Key": "tags",
                                "Value": "['leading']"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add to global filter `gf10` a tag with trailing space char ",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf10\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf10\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"trailing  \"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Verify tag with trailing space was trimmed",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf10/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":
                        [
                            {
                                "Key": "name",
                                "Value": "gf10"
                            },
                            {
                                "Key": "id",
                                "Value": "gf10"
                            },
                            {
                                "Key": "tags",
                                "Value": "['trailing']"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 6: Section",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf11'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf11\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf11\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add one section to the global filter `gf11`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf11/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf11\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf11\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": []}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add several section to the global filter `gf11`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf11/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf11\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf11\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"AND\", \"entries\": []}, {\"relation\": \"OR\", \"entries\": []}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add section in section to the global filter `gf11`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf11/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf11\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf11\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": []}]}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 7: Entry",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf12'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf12\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add one entry to the global filter `gf12`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf12/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.1.1.1\", \"q\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add two entries to the global filter `gf12`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf12/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.1.1.1\", \"q\"], [\"ip\", \"2.2.2.2\", \"w\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add one entry to the one section of the global filter `gf12`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf12/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.1.1.1\", \"ip\"]]}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add two entries to the section of the global filter `gf12`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf12/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf12\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": [[\"path\", \"/test\", \"test\"], [\"path\", \"/new\", \"new\"]]}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 8: Entry validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf13'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add valid value to ip of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.2.3.4\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot add empty value to ip of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"ip\", \"\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot add empty value to headers of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"headers\", [\"test\", \"\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot add empty value to cookies of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"cookies\", [\"test\", \"\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot add empty value to arguments of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"args\", [\"test\", \"\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot add empty name to headers of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"headers\", [\"\", \"test\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b'schema mismatched: \n'' is too short\n\nFailed validating 'minLength' in schema['properties']['name']:\n    {'description': 'Name of entity shown in UI',\n     'minLength': 1,\n     'title': 'Name',\n     'type': 'string'}'"
                    }
                },
                {
                    "Name": "Step: User cannot add empty name to cookies of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"cookies\", [\"\", \"test\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot add empty name to arguments of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"args\", [\"\", \"test\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "json",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot add same entry to the same section of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": [[\"path\", \"/test\", \"\"], [\"path\", \"/test\", \"\"]]}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n[['path', '/test', ''], ['path', '/test', '']] has non-unique elements\\n\\nFailed validating 'uniqueItems' in schema[1]['properties']['entries']:\\n    {'items': {'$ref': '#/definitions/rule'},\\n     'type': 'array',\\n     'uniqueItems': True}\\n\\nOn instance['entries']:\\n    [['path', '/test', ''], ['path', '/test', '']]\""
                    }
                },
                {
                    "Name": "Step: User can add capital name/value to the headers of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"headers\", [\"NAME\", \"VALUE\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can verify capitalized header`s name/value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "gf13"
                            },
                            {
                                "Key": "id",
                                "Value": "gf13"
                            },
                            {
                                "Key": "rule",
                                "Value": "{'relation': 'OR', 'entries': [['headers', ['NAME', 'VALUE'], '']]}"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can add capital name/value to the cookies of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"cookies\", [\"NAME\", \"VALUE\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can verify capitalized header`s name/value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "gf13"
                            },
                            {
                                "Key": "id",
                                "Value": "gf13"
                            },
                            {
                                "Key": "rule",
                                "Value": "{'relation': 'OR', 'entries': [['cookies', ['NAME', 'VALUE'], '']]}"
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add capital name/value to the arguments of the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"args\", [\"NAME\", \"VALUE\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can verify capitalized argument`s name/value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "gf13"
                            },
                            {
                                "Key": "id",
                                "Value": "gf13"
                            },
                            {
                                "Key": "rule",
                                "Value": "{'relation': 'OR', 'entries': [['args', ['NAME', 'VALUE'], '']]}"
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add entry with argument `d:<script>alert()</script>` to the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"args\", [\"d\", \"<script>alert()</script>\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can verify argument `d:<script>alert()</script>`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "gf13"
                            },
                            {
                                "Key": "id",
                                "Value": "gf13"
                            },
                            {
                                "Key": "rule",
                                "Value": "{'relation': 'OR', 'entries': [['args', ['d', '<script>alert()</script>'], '']]}"
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add entry with argument `d:<select>`to the global filter `gf13`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf13\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"args\", [\"d\", \"<select>\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can verify argument `d:<select>`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf13/"
                    },
                    "Method": "GET",
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult":[
                            {
                                "Key": "name",
                                "Value": "gf13"
                            },
                            {
                                "Key": "id",
                                "Value": "gf13"
                            },
                            {
                                "Key": "rule",
                                "Value": "{'relation': 'OR', 'entries': [['args', ['d', '<select>'], '']]}"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 9: Relation",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf14'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf14\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf14\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create two sections with same type of the global filter `gf14`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf14/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf14\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf14\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"OR\", \"entries\": []}, {\"relation\": \"OR\", \"entries\": []}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create two sections with different type of the global filter `gf14`",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf14/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf14\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf14\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [{\"relation\": \"AND\", \"entries\": []}, {\"relation\": \"OR\", \"entries\": []}]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 10: Description",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf15' with description",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf15\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf15\""
                            },
                            {
                                "Key": "description",
                                "Value": "\"Global filter with description\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Create a global filter 'gf16' without description",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf16\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf16\""
                            },
                            {
                                "Key": "description",
                                "Value": "\"\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 11: Action",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf16'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf17\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf17\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'action' to 'action-challenge'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf17/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf17\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf17\""
                            },
                            {   "Key": "\"action\"",
                                "Value": "\"action-challenge\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'action' to 'action-monitor'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf17/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf17\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf17\""
                            },
                            {   "Key": "\"action\"",
                                "Value": "\"action-monitor\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'action' to 'action-skip'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf17/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf17\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf17\""
                            },
                            {   "Key": "\"action\"",
                                "Value": "\"action-skip\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'action' to 'action-global-filter-block'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf17/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf17\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf17\""
                            },
                            {   "Key": "\"action\"",
                                "Value": "\"action-global-filter-block\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'action' to 'action-reblaze-feed-block'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf17/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf17\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf17\""
                            },
                            {   "Key": "\"action\"",
                                "Value": "\"action-reblaze-feed-block\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'action' to 'action-https-redirect'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf17/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf17\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf17\""
                            },
                            {   "Key": "\"action\"",
                                "Value": "\"action-https-redirect\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 12: Filter drop down",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf18'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'argument'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"args\", [\"/test\", \"test\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'asn'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"asn\", \"1\", \"Level 3 Parent, LLC\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'authority'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"authority\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'cookies'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"cookies\", [\"/test\", \"test\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'country'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [\n[\"country\", \"Ukraine\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'headers'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"headers\", [\"/test\", \"test\"], \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'ip'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.1.1.1\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'method'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"method\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'company'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"company\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'path'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"path\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'securitypolicyentryname'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"securitypolicyentryname\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'query'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"query\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'region'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"region\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'securitypolicyname'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"securitypolicyname\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'subregion'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"subregion\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },{
                    "Name": "Step: User can change 'filter' to 'tag'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"tag\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can change 'filter' to 'uri'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf18/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"gf18\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"uri\", \"/test\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        }
    ]
}