{
    "Name": "TA 1292 Global filters create filter from http source",
    "Skip": false,
    "Tests": [
        {
            "Name": "Test 1: Create a global filter and check source source",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a global filter 'gf1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf1\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf1\""
                            },
                            {
                                "Key": "action",
                                "Value": "\"action-monitor\""
                            },
                            {
                                "Key": "source",
                                "Value": "\"https://lists.blocklist.de/lists/strongips.txt\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Update source of the global filter 'gf1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "gf-fetch",
                        "Path": "fetch?url=https://lists.blocklist.de/lists/strongips.txt"
                    },
                    "Method": "GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "status-code"
                        }
                },
                {
                    "Name": "Step: update IP`s of global filter 'gf1'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "global-filter",
                        "Path": "gf1/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"gf1\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gf1\""
                            },
                            {
                                "Key": "action",
                                "Value": "\"action-monitor\""
                            },
                            {
                                "Key": "source",
                                "Value": "\"https://lists.blocklist.de/lists/strongips.txt\""
                            },
                            {
                                "Key": "rule",
                                "Value": "{\"relation\": \"OR\", \"entries\": [[\"ip\", \"1.9.78.242\", \"\"], [\"ip\", \"101.207.113.73\", \"\"], [\"ip\", \"103.16.202.187\", \"\"], [\"ip\", \"103.231.46.66\", \"\"], [\"ip\", \"103.255.216.43\", \"\"], [\"ip\", \"103.26.136.173\", \"\"], [\"ip\", \"103.37.83.26\", \"\"], [\"ip\", \"103.48.192.48\", \"\"], [\"ip\", \"103.48.193.7\", \"\"], [\"ip\", \"103.63.108.25\", \"\"], [\"ip\", \"103.86.180.10\", \"\"]]}"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can check rule",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "global-filter",
                        "Path": "gf1/"
                    },
                    "Method": "GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": true,
                        "SingleResult":
                        [
                            {
                                "Key": "name",
                                "Value": "gf1"
                            },
                            {
                                "Key": "id",
                                "Value": "gf1"
                            },
                            {
                                "Key": "rule",
                                "Value": "{'relation': 'OR', 'entries': [['ip', '1.9.78.242', ''], ['ip', '101.207.113.73', ''], ['ip', '103.16.202.187', ''], ['ip', '103.231.46.66', ''], ['ip', '103.255.216.43', ''], ['ip', '103.26.136.173', ''], ['ip', '103.37.83.26', ''], ['ip', '103.48.192.48', ''], ['ip', '103.48.193.7', ''], ['ip', '103.63.108.25', ''], ['ip', '103.86.180.10', '']]}"
                            }
                        ]
                    }
                }
            ]
        }
    ]
}