{
   "Name": "TA 1307 Rate limit count by attribute",
   "Skip": false,
   "Tests": [
      {
         "Name": "Test: Precondition add to Trusted sources your IP.",
         "Skip": false,
         "Steps": [
            {
               "ID": "add-my-ip-to-trusted-source",
               "Skip": false
            }
         ]
      },
      {
         "Name": "Test: Create rate limits",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: User can create rate limit with name `rl-asn`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-asn\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-asn\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"asn\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-auth`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-auth\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-auth\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"authority\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-country`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-country\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-country\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"country\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-ip`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-ip\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-ip\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"ip\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-method`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-method\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-method\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"method\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-network`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-network\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-network\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"network\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-company`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-company\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-company\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"company\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-path`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-path\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-path\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"path\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-securitypolicyentryname`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-securitypolicyentryname\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-securitypolicyentryname\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"securitypolicyentryname\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-query`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-query\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-query\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"query\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-region`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-region\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-region\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"region\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-securitypolicyname`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-securitypolicyname\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-securitypolicyname\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"securitypolicyname\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-session`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-session\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-session\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"session\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-subregion`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-subregion\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-subregion\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"subregion\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Step: User can create rate limit with name `rl-uri`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-uri\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-uri\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"uri\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Create Security policy and attach all rate limits",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: User can create security policy `test-sp` and add rate limits",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "security-policy",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "id",
                        "Value": "\"test-sp\""
                     },
                     {
                        "Key": "name",
                        "Value": "\"test-sp\""
                     },
                     {
                        "Key": "map",
                        "Value": "[{\"id\": \"__default_entry__\", \"name\": \"__default__\", \"match\": \"/\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": []},{\"id\": \"test-asn\", \"name\": \"test-asn\", \"match\": \"/test-asn\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-asn\"]},{\"id\": \"test-auth\", \"name\": \"test-auth\", \"match\": \"/test-auth\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-auth\"]},{\"id\": \"test-country\", \"name\": \"test-country\", \"match\": \"/test-country\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-country\"]},{\"id\": \"test-ip\", \"name\": \"test-ip\", \"match\": \"/test-ip\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-ip\"]},{\"id\": \"test-method\", \"name\": \"test-method\", \"match\": \"/test-method\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-method\"]},{\"id\": \"test-network\", \"name\": \"test-network\", \"match\": \"/test-network\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-network\"]},{\"id\": \"test-company\", \"name\": \"test-company\", \"match\": \"/test-company\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-company\"]},{\"id\": \"test_path\", \"name\": \"test-path\", \"match\": \"/test-path\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-path\"]},{\"id\": \"test-secpolentryname\", \"name\": \"test-secpolentryname\", \"match\": \"/test-secpolentryname\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-securitypolicyentryname\"]},{\"id\": \"test-query\", \"name\": \"test-query\", \"match\": \"/test-query\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-query\"]},{\"id\": \"test-region\", \"name\": \"test-region\", \"match\": \"/test-region\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-region\"]},{\"id\": \"test-secpolname\", \"name\": \"test-secpolname\", \"match\": \"/test-secpolname\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-securitypolicyname\"]},{\"id\": \"test-session\", \"name\": \"test-session\", \"match\": \"/test-session\",\"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-session\"]},{\"id\": \"test-subregion\", \"name\": \"test-subregion\", \"match\": \"/test-subregion\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-subregion\"]},{\"id\": \"test-uri\", \"name\": \"test-uri\", \"match\": \"/test-uri\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-uri\"]}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Create Server Group and publish changes",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Create new server group 'test.site' ",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "server-group",
                  "Path": "test-site/"
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "id",
                        "Value": "\"test-site\""
                     },
                     {
                        "Key": "name",
                        "Value": "\"test-site\""
                     },
                     {
                        "Key": "server_names",
                        "Value": "[\"test.site\"]"
                     },
                     {
                        "Key": "security_policy",
                        "Value": "\"test-sp\""
                     }
                  ]
               },
               "Expected": {
                  "Code": "201",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "id",
                        "Value": "test-site"
                     }
                  ]
               }
            },
            {
               "ID": "publish-changes",
               "Skip": false
            },
            {
               "ID": "wait-for-publish",
               "Skip": false
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-asn` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-asn` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-asn` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 3 to rate limit `rl-asn` with host `test.site` x-forwarded-for: `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 4 to rate limit `rl-asn` with host `test.site` x-forwarded-for: `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-auth` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-auth` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-auth"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-auth` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-auth"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-country` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-country` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-country"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-country` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-country"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-ip` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-ip` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-ip"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-ip` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-ip"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-method` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-method` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-method"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-method` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-method"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-network` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-network` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-network"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-network` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-network"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-company` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-company` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-company` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 3 to rate limit `rl-company` with host `test.site` and `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 4 to rate limit `rl-company` with host `test.site` and `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-path` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-path` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-path"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-path` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-path"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-secpolentryname` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-secpolentryname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolentryname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-secpolentryname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolentryname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-query` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-query` with path `/test?a=b' and host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query?a=b"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-query` with path `/test?a=b' and host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query?a=b"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 3 to rate limit `rl-query` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 4 to rate limit `rl-query` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-region` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-region` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-region"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-region` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-region"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-secpolname` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-secpolname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-secpolname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-session` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-session` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-session"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-session` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-session"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-subregion` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-subregion` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-subregion"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-subregion` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-subregion"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: Send traffics to `rl-uri` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Send Traffic 1 to rate limit `rl-uri` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-uri"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Step: Send Traffic 2 to rate limit `rl-test` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-uri"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Test: wait for logs",
         "Skip": false,
         "Steps": [
            {
               "ID": "wait-for-logs",
               "Skip": false
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-asn` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get logs `rl-asn` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-asn, status != 403, timestamp between @@NOW(-4minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"limit-name:rl-asn"
                     },
                     {
                        "Key":"data/results/2/reason",
                        "Value":"Block - rate limit threshold=1 - rl-asn - [request]"
                     },
                     {
                        "Key":"data/results/2/rl_triggers/0/action",
                        "Value":"block"
                     },
                     {
                        "Key":"data/results/3/tags/*",
                        "Value":"status:200"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-auth` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step:Get Logs `rl-auth` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-auth, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-auth"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-auth - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-country` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name":"Step: Get Logs `rl-country` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-country, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-country"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-country - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-ip` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-ip` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-ip, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-ip"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-ip - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-method` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Step: Get Logs `rl-method` rate limit\"",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-method, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-method"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-method - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-network` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get logs `rl-network` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-network, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-network"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-network - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-company` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs 'rl-company` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-company, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"limit-name:rl-company"
                     },
                     {
                        "Key":"data/results/2/reason",
                        "Value":"Block - rate limit threshold=1 - rl-company - [request]"
                     },
                     {
                        "Key":"data/results/2/rl_triggers/0/action",
                        "Value":"block"
                     },
                     {
                        "Key":"data/results/3/tags/*",
                        "Value":"status:200"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-path` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-path` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-path, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-path"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-path - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-secpolentryname` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-secpolentryname` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-secpolentryname, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-securitypolicyentryname"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-securitypolicyentryname - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-query` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-query` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-query, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"limit-name:rl-query"
                     },
                     {
                        "Key":"data/results/2/reason",
                        "Value":"Block - rate limit threshold=1 - rl-query - [request]"
                     },
                     {
                        "Key":"data/results/2/rl_triggers/0/action",
                        "Value":"block"
                     },
                     {
                        "Key":"data/results/3/tags/*",
                        "Value":"status:200"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-region` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-region` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-region, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-region"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-region - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-secpolname` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-secpolname` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-secpolname, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-securitypolicyname"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-securitypolicyname - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-session` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-session` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-session, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-session"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-session - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-subregion` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-subregion` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-subregion, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-subregion"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-subregion - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Test: Check logs `rl-uri` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Step: Get Logs `rl-uri` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /test-uri, status != 403, timestamp between @@NOW(-5minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-uri"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl-uri - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      }
   ]
}