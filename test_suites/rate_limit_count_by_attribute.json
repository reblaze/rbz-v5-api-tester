{
   "Name": "TA 1307 Rate limit count by attribute",
   "Skip": false,
   "Tests": [
      {
         "Name": "Precondition add to Trusted sources your IP.",
         "Skip": false,
         "Steps": [
            {
               "ID": "add-my-ip-to-trusted-source",
               "Skip": false
            }
         ]
      },
      {
         "Name": "Step 1 - Create rate limits",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: User can create rate limit with name `rl-asn`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-asn\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-asn\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"asn\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-auth`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-auth\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-auth\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"authority\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-country`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-country\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-country\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"country\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-ip`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-ip\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-ip\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"ip\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-method`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-method\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-method\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"method\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-network`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-network\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-network\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"network\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-company`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-company\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-company\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"company\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-path`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-path\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-path\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"path\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-securitypolicyentryname`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-securitypolicyentryname\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-securitypolicyentryname\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"securitypolicyentryname\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-query`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-query\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-query\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"query\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-region`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-region\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-region\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"region\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-securitypolicyname`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-securitypolicyname\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-securitypolicyname\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"securitypolicyname\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-session`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-session\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-session\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"session\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-subregion`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-subregion\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-subregion\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"subregion\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            },
            {
               "Name": "Test: User can create rate limit with name `rl-uri`",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "rate-limit",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "name",
                        "Value": "\"rl-uri\""
                     },
                     {
                        "Key": "id",
                        "Value": "\"rl-uri\""
                     },
                     {
                        "Key": "global",
                        "Value": "false"
                     },
                     {
                        "Key": "active",
                        "Value": "true"
                     },
                     {
                        "Key": "threshold",
                        "Value": "1"
                     },
                     {
                        "Key": "timeframe",
                        "Value": "15"
                     },
                     {
                        "Key": "action",
                        "Value": "\"action-rate-limit-block\""
                     },
                     {
                        "Key": "key",
                        "Value": "[{\"attrs\":\"uri\"}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 2 - Create Security policy and attach all rate limits",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: User can create security policy `test-sp` and add rate limits",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "security-policy",
                  "Path": ""
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "id",
                        "Value": "\"test-sp\""
                     },
                     {
                        "Key": "name",
                        "Value": "\"test-sp\""
                     },
                     {
                        "Key": "map",
                        "Value": "[{\"id\": \"__default_entry__\", \"name\": \"__default__\", \"match\": \"/\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": []},{\"id\": \"test-asn\", \"name\": \"test-asn\", \"match\": \"/test-asn\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-asn\"]},{\"id\": \"test-auth\", \"name\": \"test-auth\", \"match\": \"/test-auth\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-auth\"]},{\"id\": \"test-country\", \"name\": \"test-country\", \"match\": \"/test-country\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-country\"]},{\"id\": \"test-ip\", \"name\": \"test-ip\", \"match\": \"/test-ip\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-ip\"]},{\"id\": \"test-method\", \"name\": \"test-method\", \"match\": \"/test-method\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-method\"]},{\"id\": \"test-network\", \"name\": \"test-network\", \"match\": \"/test-network\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-network\"]},{\"id\": \"test-company\", \"name\": \"test-company\", \"match\": \"/test-company\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-company\"]},{\"id\": \"test_path\", \"name\": \"test-path\", \"match\": \"/test-path\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-path\"]},{\"id\": \"test-secpolentryname\", \"name\": \"test-secpolentryname\", \"match\": \"/test-secpolentryname\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-securitypolicyentryname\"]},{\"id\": \"test-query\", \"name\": \"test-query\", \"match\": \"/test-query\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-query\"]},{\"id\": \"test-region\", \"name\": \"test-region\", \"match\": \"/test-region\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-region\"]},{\"id\": \"test-secpolname\", \"name\": \"test-secpolname\", \"match\": \"/test-secpolname\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-securitypolicyname\"]},{\"id\": \"test-session\", \"name\": \"test-session\", \"match\": \"/test-session\",\"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-session\"]},{\"id\": \"test-subregion\", \"name\": \"test-subregion\", \"match\": \"/test-subregion\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-subregion\"]},{\"id\": \"test-uri\", \"name\": \"test-uri\", \"match\": \"/test-uri\", \"acl_profile\": \"__acldefault__\", \"acl_active\": true, \"backend_id\": \"__default__\", \"cloud_functions\": [], \"content_filter_profile\": \"__defaultcontentfilter__\", \"content_filter_active\": true, \"limit_ids\": [\"rl-uri\"]}]"
                     }
                  ]
               },
               "Expected": {
                  "Code": "200",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "ok",
                        "Value": true
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 3 - Create Server Group and publish changes",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Create new server group 'test.site' ",
               "Skip": false,
               "GenerateID": false,
               "API": {
                  "Base": "server-group",
                  "Path": "test-site/"
               },
               "Method": "POST",
               "Payload": {
                  "Params": [
                     {
                        "Key": "id",
                        "Value": "\"test-site\""
                     },
                     {
                        "Key": "name",
                        "Value": "\"test-site\""
                     },
                     {
                        "Key": "server_names",
                        "Value": "[\"test.site\"]"
                     },
                     {
                        "Key": "security_policy",
                        "Value": "\"test-sp\""
                     }
                  ]
               },
               "Expected": {
                  "Code": "201",
                  "Type": "json",
                  "Single": true,
                  "SingleResult": [
                     {
                        "Key": "id",
                        "Value": "test-site"
                     }
                  ]
               }
            },
            {
               "ID": "publish-changes",
               "Skip": false
            },
            {
               "ID": "wait-for-publish",
               "Skip": false
            }
         ]
      },
      {
         "Name": "Step 4 - Send traffics to `rl-asn` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-asn` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-asn` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 3 to rate limit `rl-asn` with host `test.site` x-forwarded-for: `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 4 to rate limit `rl-asn` with host `test.site` x-forwarded-for: `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-asn"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 5 - Send traffics to `test-auth` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `test-auth` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-auth"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `test-auth` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-auth"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 6 - Send traffics to `test-country` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `test-country` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-country"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `test-country` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-country"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 7 - Send traffics to `test-ip` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Test: Send Traffic 1 to rate limit `test-ip` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-ip"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `test-ip` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-ip"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 8 - Send traffics to `test-method` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Test: Send Traffic 1 to rate limit `test-method` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-method"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-method` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-method"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 9 - Send traffics to `test-network` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Test: Send Traffic 1 to rate limit `test-network` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-network"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-network` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-network"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 10 - Send traffics to `test-company` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Test: Send Traffic 1 to rate limit `test-company` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `test-company` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 3 to rate limit `rl-company` with host `test.site` and `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 4 to rate limit `rl-company` with host `test.site` and `x-forwarded-for:1.2.3.4`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-company"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  },
                  {
                     "Key": "x-forwarded-for",
                     "Value": "1.2.3.4"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 11 - Send traffics to `test-path` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-path` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-path"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-path` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-path"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 12 - Send traffics to `test-secpolentryname` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-secpolentryname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolentryname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-secpolentryname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolentryname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 13 - Send traffics to `test-query` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-query` with path `/test?a=b' and host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query?a=b"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-query` with path `/test?a=b' and host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query?a=b"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 3 to rate limit `rl-query` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 4 to rate limit `rl-query` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-query"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 14 - Send traffics to `test-region` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-region` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-region"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-region` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-region"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 15 - Send traffics to `test-secpolname` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-secpolname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-secpolname` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-secpolname"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 16 - Send traffics to `test-session` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-session` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-session"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-session` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-session"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 17 - Send traffics to `test-subregion` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-subregion` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-subregion"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-subregion` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-subregion"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 18 - Send traffics to `test-uri` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name": "Test: Send Traffic 1 to rate limit `rl-uri` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-uri"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "200",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            },
            {
               "Name": "Test: Send Traffic 2 to rate limit `rl-test` with host `test.site`",
               "Skip": false,
               "API": {
                  "Base": "send-traffic",
                  "Path": "/test-uri"
               },
               "Method": "GET",
               "Headers": [
                  {
                     "Key": "Host",
                     "Value": "test.site"
                  }
               ],
               "Expected": {
                  "Code": "471",
                  "Type": "content",
                  "Single": true,
                  "Text": "b''"
               }
            }
         ]
      },
      {
         "Name": "Step 19 - wait for logs",
         "Skip": false,
         "Steps": [
            {
               "ID": "wait-for-logs",
               "Skip": false
            }
         ]
      },
      {
         "Name": "Step 20 - Check logs `rl-asn` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get logs `rl-asn` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-asn, status != 403, timestamp between @@NOW(-3minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status: 200"
                     },
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status: 200"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"status: 471"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"limit-name: rl-test"
                     },
                     {
                        "Key":"data/results/2/reason",
                        "Value":"Block - rate limit threshold=1 - rl_asn - [request]"
                     },
                     {
                        "Key":"data/results/2/rl_triggers/0/action",
                        "Value":"block"
                     },
                     {
                        "Key":"data/results/3/tags/*",
                        "Value":"status: 200"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 21 - Check logs `test-auth` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Get Logs `test-auth` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-auth, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name: rl-asn"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_asn - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 22 - Check logs `test-country` rate limit",
         "Skip": false,
         "Steps": [

            {
               "Name":"Test: Get Logs `test-country` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-country, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name: rl-country"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_country - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 23 - Check logs `test-ip` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Get Logs `test-ip` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-ip, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-ip"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_ip - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 24 - Check logs `test-method` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get Logs `test-method` rate limit\"",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-method, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-method"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_method - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 25 - Check logs `test-network` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get logs `test-network` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-network, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-network"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_network - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 26 - Check logs `test-company` rate limit",
         "Skip": true,
         "Steps": [
            {
               "Name":"Test: Get Logs",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-company, status != 403, timestamp between @@NOW(-3minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/2/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/2/rl_triggers/0/action",
                        "Value":"block"
                     },
                     {
                        "Key":"data/results/3/tags/*",
                        "Value":"status:200"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 27 - Check logs `test-path` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get Logs `test-path` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-path, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 28 - Check logs `test-secpolentryname` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get Logs `test-secpolentryname` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-secpolentryname, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 29 - Check logs `test-query` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Get Logs `test-query` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-query, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/2/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/2/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/2/rl_triggers/0/action",
                        "Value":"block"
                     },
                     {
                        "Key":"data/results/3/tags/*",
                        "Value":"status:200"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 30 - Check logs `test-region` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Get Logs `test-region` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-query, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 31 - Check logs `test-secpolname` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get Logs `test-secpolname` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-secpolname, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 32 - Check logs `test-session` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get Logs `test-session` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = \"/rl-session\" status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 33 - Check logs `test-subregion` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get Logs `test-subregion` rate limit",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-subregion, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:200"
                     }
                  ]
               }
            }
         ]
      },
      {
         "Name": "Step 34 - Check logs `test-uri` rate limit",
         "Skip": false,
         "Steps": [
            {
               "Name":"Test: Get Logs",
               "Skip":false,
               "API":{
                  "Base":"logs",
                  "Path":""
               },
               "Method":"GET",
               "Headers":[
                  {
                     "Key":"syntax",
                     "Value":"string_query"
                  }
               ],
               "Arguments":[
                  {
                     "Key": "filters",
                     "Value": "path = /rl-uri, status != 403, timestamp between @@NOW(-2minutes)@@ and @@NOW(+2minutes)@@, branch=@@branch@@"
                  }
               ],
               "Expected":{
                  "Code":"200",
                  "Type":"jsonpath",
                  "Single":true,
                  "Headers":[
                     {
                        "Key":"Server",
                        "Value":"rhino-core-shield"
                     }
                  ],
                  "SingleResult":[
                     {
                        "Key":"data/results/1/tags/*",
                        "Value":"status:200"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"status:471"
                     },
                     {
                        "Key":"data/results/0/tags/*",
                        "Value":"limit-name:rl-test"
                     },
                     {
                        "Key":"data/results/0/reason",
                        "Value":"Block - rate limit threshold=1 - rl_test - [request]"
                     },
                     {
                        "Key":"data/results/0/rl_triggers/0/action",
                        "Value":"block"
                     }
                  ]
               }
            }
         ]
      }
   ]
}