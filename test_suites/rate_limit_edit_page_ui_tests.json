{
    "Name": "TA 1302 Rate limit edit page UI tests",
    "Skip": false,
    "Tests": [
        {
            "Name": "Name field validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can create a rate limit with text name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"testname\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a rate limit with long name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_a\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a rate limit with special chars name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"!@#$%^&*()<>'_-.\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_b\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a rate limit with trimmed name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"  trimmedname  \""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_c\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can check trimmedname",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "rate-limits",
                        "Path": ""
                    },
                    "Method" :"GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": false,
                        "MultipleResults":
                        [
                            [
                                {
                                    "Key": "name",
                                    "Value": "trimmedname"
                                },
                                {
                                    "Key": "id",
                                    "Value": "api_tester_c"
                                }
                            ]
                        ]
                    }
                },
                {
                    "Name": "User can not create a rate limit with empty name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_d\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n'' is too short\\n\\nFailed validating 'minLength' in schema['properties']['name']:\\n    {'description': 'Name of entity shown in UI',\\n     'minLength': 1,\\n     'title': 'Name',\\n     'type': 'string'}\\n\\nOn instance['name']:\\n    ''\""
                    }
                },
                {
                    "Name": "User can not create a rate limit with the same name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"testname\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_e\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "409",
                        "Type": "content",
                        "Single": true,
                        "Text": "b'409 Conflict: entry with name testname already exists in document [ratelimits]'"
                    }
                }
            ]
        },
        {
            "Name": "Count by validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can create rate limit with one rate limit",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"counta\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"count_a\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"attrs\":\"securitypolicyname\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User cannot delete Count by keys when we have only one",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "count_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                                {
                                "Key": "name",
                                "Value": "\"counta\""
                                },
                                {
                                "Key": "id",
                                "Value": "\"count_a\""
                                },
                                {
                                    "Key": "key",
                                    "Value": "[]"
                                }
                        ]
                    },
                     "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add more than one Count by keys",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "count_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"counta\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"count_a\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"attrs\":\"securitypolicyentryname\"},{\"attrs\":\"session\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Check that count by `header` can not be empty",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "count_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"counta\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"count_a\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"headers\":\"\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Check that count by `cookie` can not be empty",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "count_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"counta\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"count_a\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"cookies\":\"\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Check that count by `argument` can not be empty",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "count_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"counta\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"count_a\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"arguments\":\"\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can not add same key twice",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "count_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"counta\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"count_a\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"attrs\":\"securitypolicyentryname\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Timeframe validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can create a rate limit`s timeframe with positive number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeframepositive\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_f\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "15"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can not create a rate limit`s timeframe with '0' number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeframezero\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_g\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "0"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can not create a rate limit`s timeframe with negative number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeframenegative\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_i\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "-10"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can not create a rate limit`s timeframe with decimal number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeframedecimal\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_j\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "1.25"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n1.25 is not of type 'integer'\\n\\nFailed validating 'type' in schema['properties']['timeframe']:\\n    {'description': 'The time in which to limit the requests according to '\\n                    'the threshold',\\n     'title': 'Time To Limit',\\n     'type': 'integer'}\\n\\nOn instance['timeframe']:\\n    1.25\""
                    }
                },
                {
                    "Name": "User can not create a rate limit`s timeframe with empty value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeframe\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_tester_k\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "\"\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n'' is not of type 'integer'\\n\\nFailed validating 'type' in schema['properties']['timeframe']:\\n    {'description': 'The time in which to limit the requests according to '\\n                    'the threshold',\\n     'title': 'Time To Limit',\\n     'type': 'integer'}\\n\\nOn instance['timeframe']:\\n    ''\""
                    }
                }
            ]
        },
        {
            "Name": "Ban action timeframe",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can create a ban with '0' value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"banzero\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"ban_a\""
                            },
                            {
                                "Key": "is_action_ban",
                                "Value": "true"
                            },
                            {
                                "Key": "ttl",
                                "Value": "0"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text":  "b\"schema mismatched: \\n0 is less than the minimum of 1\\n\\nFailed validating 'minimum' in schema['properties']['ttl']:\\n    {'description': 'Duration time for ban action',\\n     'minimum': 1,\\n     'title': 'Ban TTL',\\n     'type': 'integer'}\\n\\nOn instance['ttl']:\\n    0\""
                    }
                },
                {
                    "Name": "User can create a ban with '1' value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"banone\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"ban_b\""
                            },
                            {
                                "Key": "is_action_ban",
                                "Value": "true"
                            },
                            {
                                "Key": "ttl",
                                "Value": "1"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text":  "b'ttl can only be a multiple of 60'"
                    }
                },
                {
                    "Name": "User can create a ban with '1440' value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"banforty\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"ban_c\""
                            },
                            {
                                "Key": "is_action_ban",
                                "Value": "true"
                            },
                            {
                                "Key": "ttl",
                                "Value": "1440"
                            }

                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a ban with '1441' value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"banfortyone\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"ban_d\""
                            },
                            {
                                "Key": "is_action_ban",
                                "Value": "true"
                            },
                            {
                                "Key": "ttl",
                                "Value": "1441"
                            }

                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text":  "b'ttl can only be a multiple of 60'"
                    }
                },
                {
                    "Name": "User can create a ban with empty value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"banempty\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"ban_e\""
                            },
                            {
                                "Key": "is_action_ban",
                                "Value": "true"
                            },
                            {
                                "Key": "ttl",
                                "Value": "\"\""
                            }

                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text":  "b\"schema mismatched: \\n'' is not of type 'integer'\\n\\nFailed validating 'type' in schema['properties']['ttl']:\\n    {'description': 'Duration time for ban action',\\n     'minimum': 1,\\n     'title': 'Ban TTL',\\n     'type': 'integer'}\\n\\nOn instance['ttl']:\\n    ''\""
                    }
                },
                {
                    "Name": "User can create a ban with negative value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"bannegative\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"ban_f\""
                            },
                            {
                                "Key": "is_action_ban",
                                "Value": "true"
                            },
                            {
                                "Key": "ttl",
                                "Value": "-1"
                            }

                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text":  "b\"schema mismatched: \\n-1 is less than the minimum of 1\\n\\nFailed validating 'minimum' in schema['properties']['ttl']:\\n    {'description': 'Duration time for ban action',\\n     'minimum': 1,\\n     'title': 'Ban TTL',\\n     'type': 'integer'}\\n\\nOn instance['ttl']:\\n    -1\""
                    }
                },
                {
                    "Name": "User can create a ban with decimal value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"bandec\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"ban_g\""
                            },
                            {
                                "Key": "is_action_ban",
                                "Value": "true"
                            },
                            {
                                "Key": "ttl",
                                "Value": "1.22"
                            }

                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text":  "b\"schema mismatched: \\n1.22 is not of type 'integer'\\n\\nFailed validating 'type' in schema['properties']['ttl']:\\n    {'description': 'Duration time for ban action',\\n     'minimum': 1,\\n     'title': 'Ban TTL',\\n     'type': 'integer'}\\n\\nOn instance['ttl']:\\n    1.22\""
                    }
                }
            ]
        },
        {
            "Name": "Include/Exclude",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can create a rate limit with one include",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"include\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"include_a\""
                            },
                            {   "Key": "include",
                                "Value": "[\"tag-include\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a rate limit with one exclude",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"exclude\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"exclude_a\""
                            },
                            {   "Key": "exclude",
                                "Value": "[\"tag-exclude\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add tag to include",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "include_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"include\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"include_a\""
                            },
                            {   "Key": "include",
                                "Value": "[\"add-tag-include\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add tag to exclude",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "exclude_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"exclude\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"exclude_a\""
                            },
                            {   "Key": "exclude",
                                "Value": "[\"add-tag-exclude\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can`t add same tag to include",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "include_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"include\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"include_a\""
                            },
                            {   "Key": "include",
                                "Value": "[\"add-tag-include\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can`t add same tag to exclude",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "exclude_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"exclude\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"exclude_a\""
                            },
                            {   "Key": "exclude",
                                "Value": "[\"add-tag-exclude\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can`t add one tag to exclude and include",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "exclude_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"exclude\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"exclude_a\""
                            },
                            {   "Key": "include",
                                "Value": "[\"include-exclude\"]"
                            },
                            {   "Key": "exclude",
                                "Value": "[\"include-exclude\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can't add tag less then 3 chars to include",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "include_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"include\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"include_a\""
                            },
                            {   "Key": "include",
                                "Value": "[\"in\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can't add tag less then 3 chars to exclude",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "exclude_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"exclude\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"exclude_a\""
                            },
                            {   "Key": "exclude",
                                "Value": "[\"ex\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }

            ]
        },
        {
            "Name": "Number of events validations",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can create a rate limit`s events validations with '0' number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeevzero\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_ev-zero\""
                            },
                            {
                                "Key": "threshold",
                                "Value": "0"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a rate limit`s events validations with '15' number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeevfifteen\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_ev-fifteen\""
                            },
                            {
                                "Key": "threshold",
                                "Value": "15"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a rate limit`s events validations with text value",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeevtext\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_ev_test\""
                            },
                            {
                                "Key": "threshold",
                                "Value": "\"text\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n'text' is not of type 'integer'\\n\\nFailed validating 'type' in schema['properties']['threshold']:\\n    {'description': 'The threshold of requests allowed',\\n     'title': 'Threshold',\\n     'type': 'integer'}\\n\\nOn instance['threshold']:\\n    'text'\""
                    }
                },
                {
                    "Name": "User can create a rate limit`s events validations with negative number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeevnegative\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_ev_negative\""
                            },
                            {
                                "Key": "threshold",
                                "Value": "-1"
                            }
                        ]
                    },
                     "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can create a rate limit`s events validations with decimal number",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"timeevdec\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"api_ev_dec\""
                            },
                            {
                                "Key": "threshold",
                                "Value": "1.25"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n1.25 is not of type 'integer'\\n\\nFailed validating 'type' in schema['properties']['threshold']:\\n    {'description': 'The threshold of requests allowed',\\n     'title': 'Threshold',\\n     'type': 'integer'}\\n\\nOn instance['threshold']:\\n    1.25\""
                    }
                }
            ]
        },
        {
            "Name": "Global checkbox",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can switch ON global checkbox",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"gcon\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"check_cb_on\""
                            },
                            {
                                "Key": "global",
                                "Value": "true"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can check global checkbox ON",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "rate-limits",
                        "Path": ""
                    },
                    "Method" :"GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": false,
                        "MultipleResults":
                        [
                            [
                                {
                                    "Key": "name",
                                    "Value": "gcon"
                                },
                                {
                                    "Key": "id",
                                    "Value": "check_cb_on"
                                },
                                {
                                    "Key": "global",
                                    "Value": true
                                }
                            ]
                        ]
                    }
                },
                {
                    "Name": "User can switch OFF global checkbox",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "check_cb_on/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"check_cb_on\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"gcon\""
                            },
                            {
                                "Key": "global",
                                "Value": "false"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can check global checkbox OFF",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "rate-limits",
                        "Path": ""
                    },
                    "Method" :"GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": false,
                        "MultipleResults":
                        [
                            [
                                {
                                    "Key": "name",
                                    "Value": "gcon"
                                },
                                {
                                    "Key": "id",
                                    "Value": "check_cb_on"
                                },
                                {
                                    "Key": "global",
                                    "Value": false
                                }
                            ]
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Active checkbox",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can switch ON active checkbox",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"activecbon\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"active_check_cb_on\""
                            },
                            {
                                "Key": "active",
                                "Value": "true"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can check active checkbox ON",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "rate-limits",
                        "Path": ""
                    },
                    "Method" :"GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": false,
                        "MultipleResults":
                        [
                            [
                                {
                                    "Key": "id",
                                    "Value": "active_check_cb_on"
                                },
                                 {
                                    "Key": "name",
                                    "Value": "activecbon"
                                },
                                {
                                    "Key": "active",
                                    "Value": true
                                }
                            ]
                        ]
                    }
                },
                {
                    "Name": "User can switch OFF active checkbox",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "active_check_cb_on/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"active_check_cb_on\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"activecbon\""
                            },
                            {
                                "Key": "active",
                                "Value": "false"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can check active checkbox OFF",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "rate-limits",
                        "Path": ""
                    },
                    "Method" :"GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": false,
                        "MultipleResults":
                        [
                            [
                                {
                                    "Key": "id",
                                    "Value": "active_check_cb_on"
                                },
                                {
                                    "Key": "active",
                                    "Value": false
                                }
                            ]
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Tags field",
            "Skip": false,
            "Steps": [
                {
                    "Name": "User can create a rate limit without tags",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add a one tag",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"facebook\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add more than one tag",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"api\", \"allowedlist\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add a very long tag",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add a tag with specify chars",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"!@#$%^&*()<>'_-.\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add a tag with 1/2 chars",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"1/2\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add a tag with space chars",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\" \"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add a tag with leading space char",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"  leading\"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "User can add a tag with trailing space char ",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "rate-limit",
                        "Path": "tags_a/"
                    },
                    "Method": "PUT",
                    "Payload": {
                         "Params": [
                            {
                                "Key": "name",
                                "Value": "\"tagsa\""
                            },
                            {
                                "Key": "id",
                                "Value": "\"tags_a\""
                            },
                            {   "Key": "tags",
                                "Value": "[\"trailing  \"]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        }
    ]
}