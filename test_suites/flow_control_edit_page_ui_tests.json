{
    "Name": "TA 1319 Flow control edit page UI tests",
    "Skip": false,
    "Tests": [
        {
            "Name": "Test 1: Create a flow control from the list page",
            "Skip": false,
            "Steps": [
                {
                    "Name": "Step: Create a flow control 'fc'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 2: Name field validations",
            "Skip": true,
            "Steps": [
                {
                    "Name": "Step: User can create a flow control with text name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_text_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"flow_control_text_name\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with empty name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_empty_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n'' is too short\\n\\nFailed validating 'minLength' in schema['properties']['name']:\\n    {'description': 'Name of entity shown in UI',\\n     'minLength': 1,\\n     'title': 'Name',\\n     'type': 'string'}\\n\\nOn instance['name']:\\n    ''\""
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with exist name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_exist_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"flow_control_text_name\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "409",
                        "Type": "content",
                        "Single": true,
                        "Text": "b'409 Conflict: entry with name flow_control_text_name already exists in document [flowcontrol]'"
                    }
                },
                {
                    "Name": "Step: User can create a flow control with long name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_long_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create a flow control with special chars name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_spec_chars_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"!@#$%^&*()<>'_-.\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_space_char_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\" \""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User can create a flow control with leading space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_leading_space_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"  flow_control_leading_space_name\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User check flow control with leading space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "flow-control",
                        "Path": "flow_control_leading_space_name/"
                    },
                    "Method" :"GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": true,
                        "SingleResult":
                        [
                            {
                                "Key": "name",
                                "Value": "flow_control_leading_space_name"
                            },
                            {
                                "Key": "id",
                                "Value": "flow_control_leading_space_name"
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User can create a flow control with trailing space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"flow_control_trailing_space_name\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"flow_control_trailing_space_name  \""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User check flow control with trailing space char name",
                    "Skip": false,
                    "GenerateID": false,
                    "API":
                    {
                        "Base": "flow-control",
                        "Path": "flow_control_trailing_space_name/"
                    },
                    "Method" :"GET",
                    "Expected":
                    {
                        "Code": "200",
                        "Type": "json",
						"Single": true,
                        "SingleResult":
                        [
                            {
                                "Key": "name",
                                "Value": "flow_control_trailing_space_name"
                            },
                            {
                                "Key": "id",
                                "Value": "flow_control_trailing_space_name"
                            }
                        ]
                    }
                }
            ]
        },
        {
            "Name": "Test 3: Time frame",
            "Skip": true,
            "Steps": [
                {
                    "Name": "Step: Create a flow control 'fc-60'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-60\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-60\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "60"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with empty timeframe",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-empty\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-empty\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": ""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with decimal timeframe",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-dec\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-dec\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "6,8"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with text timeframe",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-text\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-text\""
                            },
                            {
                                "Key": "timeframe",
                                "Value": "\"text\""
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b\"schema mismatched: \\n'text' is not of type 'number'\\n\\nFailed validating 'type' in schema['properties']['timeframe']:\\n    {'description': 'The time in which to limit the requests according to '\\n                    'the threshold',\\n     'title': 'Time To Limit',\\n     'type': 'number'}\\n\\nOn instance['timeframe']:\\n    'text'\""
                    }
                }
            ]
        },
        {
            "Name": "Test 4: Count by",
            "Skip": true,
            "Steps": [
                {
                    "Name": "Step: Create a flow control 'fc-add-one-entry'",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-add-one-entry\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-add-one-entry\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"attrs\": \"ip\"}, {\"headers\": \"head\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: Delete one of two entries",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": "fc-add-one-entry/"
                    },
                    "Method": "PUT",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-add-one-entry\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-add-one-entry\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"attrs\": \"ip\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "200",
                        "Type": "json",
                        "Single": true,
                        "SingleResult": [
                            {
                                "Key": "ok",
                                "Value": true
                            }
                        ]
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with no entry",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-no-entry\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-no-entry\""
                            },
                            {
                                "Key": "key",
                                "Value": "[]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with two same entries",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-same-entries\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-same-entries\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"attrs\": \"ip\"},{\"attrs\": \"ip\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with empty header`s name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-header-entry\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-header-entry\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"headers\": \"\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with empty cookie`s name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-cookie-entry\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-cookie-entry\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"cookies\": \"\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                },
                {
                    "Name": "Step: User cannot create a flow control with empty attribute`s name",
                    "Skip": false,
                    "GenerateID": false,
                    "API": {
                        "Base": "flow-control",
                        "Path": ""
                    },
                    "Method": "POST",
                    "Payload": {
                        "Params": [
                            {
                                "Key": "id",
                                "Value": "\"fc-attr-entry\""
                            },
                            {
                                "Key": "name",
                                "Value": "\"fc-attr-entry\""
                            },
                            {
                                "Key": "key",
                                "Value": "[{\"attrs\": \"\"}]"
                            }
                        ]
                    },
                    "Expected": {
                        "Code": "400",
                        "Type": "content",
                        "Single": true,
                        "Text": "b''"
                    }
                }
            ]
        }
    ]
}